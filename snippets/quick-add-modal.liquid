<quick-add-dialog id="quick-add-dialog">
  <dialog
    class="quick-add-modal dialog-modal color-{{ settings.popover_color_scheme }}"
    ref="dialog"
    scroll-lock
  >
    <button
      ref="closeButton"
      on:click="/closeDialog"
      class="button button-unstyled close-button quick-add-modal__close"
      aria-label="{{ 'accessibility.close_dialog' | t }}"
    >
      {{- 'icon-close.svg' | inline_asset_content -}}
    </button>
    <div
      id="quick-add-modal-content"
      class="quick-add-modal__content"
    ></div>
  </dialog>
</quick-add-dialog>

{% stylesheet %}
  @media screen and (min-width: 750px) {
    .quick-add-modal {
      width: 90%;
      max-width: 1000px;
    }
  }

  @media screen and (min-width: 1400px) {
    .quick-add-modal {
      width: 1200px;
      max-width: 1200px;
    }
  }

  .quick-add-modal {
    padding: 0;
    border: var(--style-border-popover);
    max-height: 90vh;
    overflow: hidden;
    min-height: 500px;
    box-shadow: 0 5px 30px rgb(0 0 0 / var(--opacity-15));
    display: flex;
    flex-direction: column;

    @media screen and (max-width: 749px) {
      width: 100%;
      max-width: 100vw;
      max-height: 100vh;
      border-radius: 0;
      min-height: unset;
      /* height: 100vh; */
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      margin: 0;
    }
  }

  /* Hide dialog when closed to prevent overlap with other content */
  .quick-add-modal:not([open]) {
    display: none !important;
  }

  .quick-add-modal[open] {
    @media screen and (min-width: 750px) {
      display: flex;
    }

    @media screen and (max-width: 749px) {
      display: flex;
      flex-direction: column;
    }
  }

  /* Show view-more-details__wrapper on both desktop and mobile - same content as desktop */

  .quick-add-modal[open] {
    animation: modalSlideInTop var(--animation-speed) var(--animation-easing) forwards;
  }

  .quick-add-modal.dialog-closing {
    animation: modalSlideOutTop var(--animation-speed) var(--animation-easing) forwards;
  }

  .quick-add-modal__close {
    position: absolute;
    top: var(--margin-2xs);
    right: var(--margin-2xs);
    transition: transform 0.15s var(--animation-timing-bounce);
    z-index: calc(var(--layer-raised) + 1);
    pointer-events: all;
    cursor: pointer;
    outline: none;
  }

  .quick-add-modal__close:active {
    transform: scale(0.8);
  }

  .quick-add-modal__content {
    width: 100%;
    display: flex;
    flex: 1 1 auto;
    min-height: 0;
    height: 100%;
    overflow: hidden;
    padding: 20px;
    /* Ensure flex children can shrink and scroll */
    align-items: stretch;

    @media screen and (min-width: 750px) {
      /* No additional constraints needed */
    }

    @media screen and (max-width: 749px) {
      flex-direction: column;
      min-height: unset;
      height: 100%;
      padding: 0;
      gap: 0;
      overflow-y: auto;
      overflow-x: hidden;
    }
  }

  /* Override product-information__grid to use flex layout in quick add modal */
  .quick-add-modal__content .product-information__grid {
    display: flex !important;
    flex-direction: row;
    width: 100% !important;
    flex: 1 1 auto;
    min-height: 0;
    height: 100%;
    gap: 0;
    grid-template-columns: none !important;
    /* Ensure flex children can shrink and scroll properly */
    align-items: stretch;
    overflow: hidden !important; /* Prevent overflow from parent */

    @media screen and (max-width: 749px) {
      flex-direction: column;
      min-height: 0;
      height: auto;
    }
  }

  /* Ensure all direct children are visible */
  /* BUT: Exception for skeleton loading elements which need flex layout */
  .quick-add-modal__content .product-information__grid > *:not(.quick-add-modal__skeleton-media):not(.quick-add-modal__skeleton-details) {
    display: block !important;
    visibility: visible !important;
  }

  /* Skeleton media and details should use flex layout */
  .quick-add-modal__content .product-information__grid > .quick-add-modal__skeleton-media,
  .quick-add-modal__content .product-information__grid > .quick-add-modal__skeleton-details {
    display: flex !important;
    visibility: visible !important;
  }

  .quick-add-modal__content .media-gallery--grid .media-gallery__grid {
    grid-template-columns: 1fr;
    display: grid !important;
  }

  /* For grid layout, ensure first image is visible */
  .quick-add-modal__content .product-information__media .media-gallery--grid .product-media-container:first-child {
    display: grid !important;
    width: 100% !important;
    height: 100% !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  .quick-add-modal__content .product-information__media .media-gallery--grid .product-media-container:first-child .product-media,
  .quick-add-modal__content .product-information__media .media-gallery--grid .product-media-container:first-child img {
    width: 100% !important;
    height: 100% !important;
    object-fit: contain !important;
    display: block !important;
    visibility: visible !important;
  }

  /* Hide all media containers except the first one in quick add modal */
  .quick-add-modal__content .product-information__media .product-media-container:not(:first-child) {
    display: none !important;
  }

  /* Ensure first media container is visible */
  .quick-add-modal__content .product-information__media .product-media-container:first-child {
    display: flex !important;
    width: 100% !important;
    height: 100% !important;
    align-items: center;
    justify-content: center;
    visibility: visible !important;
    opacity: 1 !important;
  }

  .quick-add-modal__content .media-gallery--grid.media-gallery--two-column .product-media-container:first-child {
    grid-column: auto;
  }

  .quick-add-modal__content {
    /* One column */
    .media-gallery--grid:not(.media-gallery--two-column) .product-media > *,
    /* Two column, small first image */
    .media-gallery--grid.media-gallery--two-column:not(.media-gallery--large-first-image)
    .product-media-container:nth-of-type(odd)
    .product-media > *,
    /* Two column, large first image */
    .media-gallery--grid.media-gallery--two-column.media-gallery--large-first-image
      .product-media-container:is(:first-of-type, :nth-of-type(even))
      .product-media > *,
      /* Carousel */
    .media-gallery--carousel slideshow-container {
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
    }
  }

  .quick-add-modal__content .view-more-details__wrapper {
    display: flex;
    justify-content: flex-start;
    width: 100%;
  }

  .view-more-details__wrapper .view-more-details {
    display: flex;
    align-items: center;
    width: fit-content;
  }

  /* Hide product-header - we want same content structure as desktop */
  /* The product-header was a mobile-only addition that we don't want */
  .quick-add-modal__content .product-header {
    display: none !important;
    visibility: hidden !important;
  }

  .quick-add-modal__content .product-media-container__zoom-button {
    cursor: default;
  }

  .quick-add-modal__content .product-details {
    flex: 1 1 auto !important; /* Take all available space */
    display: flex !important;
    flex-direction: column;
    justify-content: flex-start;
    min-height: 0 !important; /* Critical: allow flex item to shrink below content size */
    height: 100% !important; /* Fill available height */
    max-height: 100% !important; /* Constrain to parent height */
    overflow-y: auto !important;
    overflow-x: hidden !important;
    padding-left: 20px;
    order: 1 !important;
    width: auto !important;
    max-width: none !important;
    visibility: visible !important;
    /* Ensure scrolling works properly */
    position: relative;
    -webkit-overflow-scrolling: touch;

    dialog[open] & {
      animation: fadeSlideIn 0.3s var(--animation-timing-fade-in) both;
      animation-delay: 0.1s;
    }

    @media screen and (min-width: 1400px) {
      flex: 1 1 auto !important;
      width: auto !important;
      max-width: none !important;
    }

    @media screen and (max-width: 749px) {
      flex: 0 0 auto !important;
      width: 100% !important;
      max-width: 100% !important;
      padding-inline: var(--padding-xl);
      padding-top: 0;
      padding-bottom: var(--padding-xl);
      height: auto !important;
      min-height: 0 !important;
      max-height: 60vh !important;
      overflow-y: auto !important;
      overflow-x: hidden !important;
      order: 1 !important;
    }
  }

  .quick-add-modal__content .product-details > .group-block {
    flex-grow: 1;
    min-height: 0; /* Allow shrinking */
    display: flex;
    flex-direction: column;

    @media screen and (max-width: 749px) {
      /* Ensure group-blocks containing essential elements are visible on mobile */
      display: block !important;
      visibility: visible !important;
    }
  }

  /* Ensure all essential content elements are visible (desktop and mobile) */
  /* These are the ONLY elements that should be visible in quick add modal */
  .quick-add-modal__content .product-details .view-product-title,
  .quick-add-modal__content .product-details variant-picker,
  .quick-add-modal__content .product-details product-price,
  .quick-add-modal__content .product-details product-inventory,
  .quick-add-modal__content .product-details .buy-buttons-block,
  .quick-add-modal__content .product-details product-form-component {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  .quick-add-modal__content > * {
    min-height: 0;
  }

  .quick-add-modal__content .product-details :is(.view-product-title, .buy-buttons-block) {
    flex: 0 0 auto;
  }
  .quick-add-modal__content .product-details :is(.buy-buttons-block) {
    /* margin-top: auto; */
  }

  /* Build Your Set: Add to Set button â€“ match add-to-cart enabled/disabled styles */
  .quick-add-modal__content[data-build-your-set] .build-your-set-add-to-session-button {
    height: var(--height-buy-buttons);
    text-transform: uppercase !important;
    background-color: #7295BB !important;
    color: #ffffff !important;
    border: none !important;
    font-weight: 500;
  }
  .quick-add-modal__content[data-build-your-set] .build-your-set-add-to-session-button:hover:not(:disabled) {
    background-color: #5a7a9a !important;
    color: #ffffff !important;
  }
  .quick-add-modal__content[data-build-your-set] .build-your-set-add-to-session-button:disabled {
    background-color: #cccccc !important;
    color: #666666 !important;
    cursor: not-allowed;
  }

  .quick-add-modal__content .product-details .variant-picker {
    flex: 0 0 auto;

    padding-block: min(var(--gap-2xl), var(--gap));
    margin-block-end: calc(var(--focus-outline-offset) + var(--focus-outline-width));
    @media screen and (max-width: 749px) {
      padding-inline: 0 !important;
      padding: 0;
    }

  }
  .quick-add-modal__content .product-details > .group-block > .group-block-content > *:not(:first-child):not(:has(variant-picker)) {
    @media screen and (max-width: 749px) {
      padding-inline: 0 !important;
      padding: 0;
    }
  }

  .quick-add-modal__content .variant-option--swatches {
    padding-inline-start: var(--padding-2xs);
  }

  .quick-add-modal__content .variant-option--swatches legend {
    margin-inline-start: calc(-1 * var(--padding-2xs));
  }

  .quick-add-modal__content:not(:has(.product-information__media)) .product-details {
    flex: 1 1 100%;
  }

  /* Ensure skeleton details are visible when loading */
  .quick-add-modal__content:has(.quick-add-modal__loading-skeleton) .product-details,
  .quick-add-modal__content:has(.quick-add-modal__loading-skeleton) .quick-add-modal__skeleton-details {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  .quick-add-modal__content:has(.quick-add-modal__loading-skeleton) .product-details * {
    display: block !important;
    visibility: visible !important;
  }

  .quick-add-modal__content .view-product-title {
    display: flex;
    padding-block: 0;
    margin-block-end: 12px;

    /* Prevent overlap between title and close button */
    padding-inline: 0 calc(var(--minimum-touch-target) / 2);

  }

  .quick-add-modal__content .view-product-title a {
    color: inherit;
    text-decoration: none;
    text-align: left;
    font-size: var(--font-size--2xl);
    font-weight: 600;
    line-height: 1.2;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    overflow: hidden;
    text-overflow: ellipsis;
    transition: color 0.2s var(--animation-easing);
  }

  /* Hide ALL duplicate product title elements - only show .view-product-title */
  /* Apply to both desktop AND mobile - same content rules */
  .quick-add-modal__content .product-details .text-block:has(h1),
  .quick-add-modal__content .product-details .text-block:has(h2),
  .quick-add-modal__content .product-details .text-block:has(h3) {
    display: none !important;
  }

  /* Hide any standalone headings that aren't in .view-product-title */
  .quick-add-modal__content .product-details h1:not(.view-product-title h1):not(.view-product-title *),
  .quick-add-modal__content .product-details h2:not(.view-product-title h2):not(.view-product-title *),
  .quick-add-modal__content .product-details h3:not(.view-product-title h3):not(.view-product-title *) {
    /* display: none !important; */
  }

  /* Hide product-title-text class */
  .quick-add-modal__content .product-details .product-title-text {
    display: none !important;
  }

  /* Hide extra content in product-details in quick add modal - apply to ALL screen sizes */
  /* Only show essential elements: view-product-title, variant-picker, product-price, product-inventory, buy-buttons-block */
  /* BUT: Don't hide skeleton loading elements */
  .quick-add-modal__content:not(:has(.quick-add-modal__loading-skeleton))
    .product-details
    *:not(
      .group-block,
      .group-block-content,
      .buy-buttons-block,
      .buy-buttons-block *,
      .view-product-title,
      .view-product-title *,
      variant-picker,
      variant-picker *,
      product-price,
      product-price *,
      product-inventory,
      product-inventory *,
      .view-more-details__wrapper,
      .view-more-details__wrapper *,
      .text-block:has(h1),
      .text-block:has(h2),
      .text-block:has(h3)
    ) {
    /* Hide other content - same rules for desktop and mobile */
    display: none !important;
  }

  .quick-add-modal__content
    .group-block:not(
      :has(
          .buy-buttons-block,
          .buy-buttons-block *,
          .view-product-title,
          .view-product-title *,
          variant-picker,
          variant-picker *,
          product-price,
          product-price *,
          product-inventory,
          product-inventory *,
          .view-more-details__wrapper,
          .view-more-details__wrapper *
        ),
      .buy-buttons-block
    ) {
    display: none;
  }

  @media screen and (min-width: 750px) {
    .quick-add-modal__content .group-block-content {
      gap: 0;
    }

    .quick-add-modal__content .media-gallery__grid {
      gap: min(var(--gap-2xs), var(--image-gap));
      border-radius: var(--style-border-radius-popover, 0);
    }

    .quick-add-modal__content .media-gallery--grid .product-media img {
      border-radius: 0;
    }
  }

  .quick-add-modal__content slideshow-slide:not([aria-hidden='false']) {
    content-visibility: auto;
  }

  /* Ensure first slide content is always visible */
  .quick-add-modal__content .product-information__media slideshow-slide:first-child {
    content-visibility: visible !important;
  }

  .quick-add-modal__content .product-information__media {
    flex: 0 0 52%; /* Similar to personalisation modal preview */
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(0deg, rgba(0, 0, 0, 0.02), rgba(0, 0, 0, 0.02));
    position: relative;
    overflow: hidden;
    /* Remove animation to match personalize modal - no fade in */
    animation: none !important;
    min-width: 0 !important;
    order: 0 !important;

  
    @media screen and (max-width: 749px) {
      flex: 0 0 auto !important;
      width: 100% !important;
      max-width: 100% !important;
      min-height: 200px;
      height: auto;
      max-height: none;
      order: 0 !important;
    }
  }

  /* Disable all transitions and animations in media gallery within quick add modal */
  .quick-add-modal__content .product-information__media * {
    transition: none !important;
    animation: none !important;
  }

  /* No transitions on images - instant update like personalize modal */
  .quick-add-modal__content .product-information__media img {
    transition: none !important;
    opacity: 1 !important;
  }

  /* Ensure media gallery replacement is instant (no flicker) */
  .quick-add-modal__content media-gallery[data-quick-add-modal="true"] {
    transition: none !important;
    animation: none !important;
  }

  /* When media gallery is replaced, ensure smooth transition */
  .quick-add-modal__content .product-information__media media-gallery {
    will-change: auto !important;
  }

  .quick-add-modal__content .product-information__media media-gallery {
    pointer-events: none;
    width: 100% !important;
    height: 100% !important;
    display: block !important;
    align-items: center;
    justify-content: center;
    position: relative;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Ensure slideshow-component is visible but disable interactions */
  .quick-add-modal__content .product-information__media slideshow-component {
    width: 100% !important;
    height: 100% !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    /* Disable slideshow functionality - just show static first image */
    pointer-events: none;
  }

  .quick-add-modal media-gallery {
    padding: 0;
  }

  .quick-add-modal__content .product-information__media slideshow-arrows {
    display: none;
  }

  .quick-add-modal__content .product-information__media slideshow-container {
    display: block !important;
    width: 100%;
    height: 100%;
  }

  .quick-add-modal__content .product-information__media slideshow-slides {
    display: flex !important;
    flex-direction: row;
    gap: 0;
    overflow: hidden;
    scroll-snap-type: none;
    width: 100% !important;
    height: 100% !important;
    position: relative;
    /* Disable scrolling and animations */
    scroll-behavior: auto !important;
    transform: none !important;
  }

  .quick-add-modal__content .product-information__media slideshow-slide {
    width: 100%;
    flex: none;
    scroll-snap-align: unset;
    position: relative;
    transform: none;
    /* Remove transition to prevent flickering */
    transition: none !important;
  }

  /* Hide all slides except the first one - show only one image like personalisation modal */
  .quick-add-modal__content .product-information__media slideshow-slide:not(:first-child) {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
  }

  /* Force first slide to be visible regardless of aria-hidden - static display like personalize modal */
  .quick-add-modal__content .product-information__media slideshow-slide:first-child {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    align-items: center;
    justify-content: center;
    position: relative;
    opacity: 1 !important;
    visibility: visible !important;
    /* Disable any transforms or animations */
    transform: none !important;
    animation: none !important;
  }

  /* Override aria-hidden for first slide */
  .quick-add-modal__content .product-information__media slideshow-slide:first-child[aria-hidden='true'] {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Ensure all image/media elements are visible in first slide - no transitions to prevent flickering */
  .quick-add-modal__content .product-information__media slideshow-slide:first-child .product-media,
  .quick-add-modal__content .product-information__media slideshow-slide:first-child .product-media > *,
  .quick-add-modal__content .product-information__media slideshow-slide:first-child img,
  .quick-add-modal__content .product-information__media slideshow-slide:first-child video,
  .quick-add-modal__content .product-information__media slideshow-slide:first-child iframe,
  .quick-add-modal__content .product-information__media slideshow-slide:first-child .product-media-container,
  .quick-add-modal__content .product-information__media .product-media,
  .quick-add-modal__content .product-information__media .product-media img,
  .quick-add-modal__content .product-information__media img,
  .quick-add-modal__content .product-information__media .product-media__image,
  .quick-add-modal__content .product-information__media .product-media__image img {
    width: 100% !important;
    height: 100% !important;
    max-width: 100% !important;
    max-height: 100% !important;
    object-fit: contain !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    /* Disable transitions and transforms to prevent flickering */
    transition: none !important;
    transform: none !important;
    animation: none !important;
  }

  /* Ensure product-media-container in first slide is visible */
  .quick-add-modal__content .product-information__media slideshow-slide:first-child .product-media-container {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    align-items: center;
    justify-content: center;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Ensure product-media element itself is visible */
  .quick-add-modal__content .product-information__media .product-media {
    width: 100% !important;
    height: 100% !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    position: relative;
  }

  /* Handle deferred-media (lazy loaded images) */
  .quick-add-modal__content .product-information__media deferred-media,
  .quick-add-modal__content .product-information__media deferred-media img,
  .quick-add-modal__content .product-information__media deferred-media > * {
    width: 100% !important;
    height: 100% !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    object-fit: contain !important;
  }

  /* Ensure any nested image elements are visible */
  .quick-add-modal__content .product-information__media * img {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    width: 100% !important;
    height: 100% !important;
    object-fit: contain !important;
  }

  /* General rule: make sure first visible slide or container shows its content */
  .quick-add-modal__content .product-information__media > *:first-child,
  .quick-add-modal__content .product-information__media media-gallery > *:first-child,
  .quick-add-modal__content .product-information__media slideshow-component > *:first-child,
  .quick-add-modal__content .product-information__media slideshow-slides > *:first-child {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* View Product button on image container */
  .quick-add-modal__content .product-information__media .quick-add-modal__view-product-button {
    position: absolute;
    bottom: 20px;
    right: 20px;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 16px;
    background: #FFFFFF;
    border: 1px solid #7295BB;
    border-radius: 50px;
    color: #7295BB;
    text-decoration: none;
    font-family: 'Outfit', sans-serif;
    font-style: normal;
    font-weight: 500;
    font-size: 14px;
    line-height: 20px;
    text-transform: uppercase;
    z-index: var(--layer-raised);
    transition: all 0.2s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .quick-add-modal__content .product-information__media .quick-add-modal__view-product-button:hover {
    background: #7295BB;
    color: #FFFFFF;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .quick-add-modal__content .product-information__media .quick-add-modal__view-product-button-icon {
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .quick-add-modal__content .product-information__media .quick-add-modal__view-product-button-icon svg {
    width: 100%;
    height: 100%;
    stroke: currentColor;
    fill: none;
  }

  @media screen and (min-width: 750px) {
    .quick-add-modal__content .product-information__media .quick-add-modal__view-product-button {
      padding: 12px 20px;
      font-size: 16px;
      line-height: 140%;
    }

    .quick-add-modal__content .product-information__media .quick-add-modal__view-product-button-icon {
      width: 18px;
      height: 18px;
    }
  }

  /* Only hide non-first slides with aria-hidden */
  .quick-add-modal__content .product-information__media slideshow-slide:not(:first-child)[aria-hidden='true'] {
    display: none !important;
  }

  /* Remove animations to prevent flickering - show static image like personalize modal */
  .quick-add-modal__content .product-information__media slideshow-slide {
    animation: none !important;
  }

  .quick-add-modal__content .product-information__media slideshow-controls {
    display: none;
  }

  .quick-add-modal__content .sticky-content,
  .quick-add-modal__content .sticky-content--desktop {
    top: 0;
  }

  /* Hide text blocks with rich text content (except product-price which is allowed) */
  /* Hide view-more-details__wrapper to match desktop behavior */
  .quick-add-modal__content .product-details .text-block.rte:not(:has(product-price)),
  .quick-add-modal__content .view-more-details__wrapper {
    display: none !important;
  }

  /* Hide free shipping and delivery messages in quick add modal */
  .quick-add-modal__content .product-shipping-messages,
  .quick-add-modal__content .shipping-message {
    display: none !important;
    visibility: hidden !important;
  }

  /* Always show skeleton loading elements - override any hiding rules */
  /* This rule has high specificity to ensure skeleton elements are visible */
  /* But don't override display for skeleton-media (needs flex) and skeleton-image (needs proper positioning) */
  .quick-add-modal__content [class*="quick-add-modal__skeleton"]:not(.quick-add-modal__skeleton-media):not(.quick-add-modal__skeleton-image),
  .quick-add-modal__content [class*="quick-add-modal__skeleton"] *:not(.quick-add-modal__skeleton-image),
  .quick-add-modal__loading-skeleton *:not(.quick-add-modal__skeleton-image):not(.quick-add-modal__skeleton-media),
  .quick-add-modal__loading-skeleton [class*="quick-add-modal__skeleton"]:not(.quick-add-modal__skeleton-media):not(.quick-add-modal__skeleton-image) {
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Skeleton media should be flex */
  .quick-add-modal__skeleton-media {
    display: flex !important;
  }

  /* Skeleton image should be block for proper centering within flex container */
  .quick-add-modal__skeleton-image {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Skeleton details and variants container should be flex */
  .quick-add-modal__skeleton-details,
  .product-details.quick-add-modal__skeleton-details,
  .quick-add-modal__skeleton-variants {
    display: flex !important;
  }

  /* Skeleton line elements should be block */
  .quick-add-modal__skeleton-line {
    display: block !important;
  }

  @keyframes fadeSlideIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Loading Skeleton Styles */
  .quick-add-modal__loading-skeleton {
    display: flex !important;
    flex-direction: row;
    width: 100% !important;
    height: 100% !important;
    gap: 0;
    min-height: 500px;
    animation: fadeIn 0.3s var(--animation-timing-fade-in) both;
  }

  /* Ensure skeleton elements are always visible and not hidden by product-details rules */
  /* This needs to have higher specificity than the hiding rules */
  .quick-add-modal__loading-skeleton .product-details,
  .quick-add-modal__loading-skeleton .quick-add-modal__skeleton-details,
  .quick-add-modal__content .quick-add-modal__loading-skeleton .product-details,
  .quick-add-modal__content .quick-add-modal__loading-skeleton .quick-add-modal__skeleton-details {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Show all skeleton child elements when inside loading skeleton */
  .quick-add-modal__loading-skeleton .product-details > *,
  .quick-add-modal__loading-skeleton .quick-add-modal__skeleton-details > *,
  .quick-add-modal__content .quick-add-modal__loading-skeleton .product-details > *,
  .quick-add-modal__content .quick-add-modal__loading-skeleton .quick-add-modal__skeleton-details > * {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  .quick-add-modal__skeleton-media {
    flex: 0 0 45.65% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    background: linear-gradient(0deg, rgba(0, 0, 0, 0.02), rgba(0, 0, 0, 0.02));
    position: relative;
    overflow: hidden;
    width: 45.65% !important;
    max-width: 45.65% !important;
    min-width: 0 !important;
    height: 100% !important;
    min-height: 500px;
    /* Override any block display rules */
    visibility: visible !important;
    opacity: 1 !important;
    /* Ensure proper flex behavior */
    flex-direction: row !important;
    flex-wrap: nowrap !important;

    @media screen and (min-width: 1400px) {
      flex: 0 0 525px !important;
      width: 525px !important;
      max-width: 525px !important;
    }

    @media screen and (max-width: 750px) {
      flex: 0 0 40% !important;
      width: 100% !important;
      max-width: 100% !important;
      min-height: 200px;
    }
  }

  /* Also apply to product-information__media when it's a skeleton - ensure proper centering */
  .quick-add-modal__skeleton-media.product-information__media,
  .quick-add-modal__loading-skeleton .product-information__media.quick-add-modal__skeleton-media {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    flex-direction: row !important;
  }

  /* Ensure skeleton image is properly centered within skeleton media container */
  /* The parent has flex with center alignment, so the child should center automatically */
  .quick-add-modal__skeleton-media .quick-add-modal__skeleton-image,
  .quick-add-modal__skeleton-media.product-information__media .quick-add-modal__skeleton-image {
    display: block !important;
    position: relative !important;
    margin: 0 !important;
    /* Remove any transforms or positioning that might move it */
    transform: none !important;
    left: auto !important;
    right: auto !important;
    top: auto !important;
    bottom: auto !important;
    float: none !important;
    /* Ensure it's visible */
    visibility: visible !important;
    opacity: 1 !important;
    /* Flexbox will center it automatically when parent has align-items: center and justify-content: center */
    align-self: center;
  }

  /* Ensure skeleton media container properly centers its children */
  .quick-add-modal__skeleton-media,
  .quick-add-modal__skeleton-media.product-information__media {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    flex-direction: row !important;
  }

  .quick-add-modal__skeleton-image {
    /* Use fixed dimensions that work well and center properly */
    width: 400px;
    height: 400px;
    max-width: calc(100% - 40px);
    max-height: calc(100% - 40px);
    min-width: 250px;
    min-height: 250px;
    aspect-ratio: 1 / 1;
    background: linear-gradient(
      90deg,
      rgb(var(--color-foreground-rgb) / 0.05) 0%,
      rgb(var(--color-foreground-rgb) / 0.12) 50%,
      rgb(var(--color-foreground-rgb) / 0.05) 100%
    );
    background-size: 200% 100%;
    border-radius: 4px;
    animation: skeleton-loading 1.5s ease-in-out infinite;
    /* Ensure proper positioning - flexbox will center this automatically */
    display: block !important;
    margin: 0 !important;
    padding: 0 !important;
    align-self: center !important;
    flex-shrink: 0 !important;
    flex-grow: 0 !important;
    position: relative !important;
    /* Reset any positioning that might interfere */
    left: auto !important;
    right: auto !important;
    top: auto !important;
    bottom: auto !important;
    transform: none !important;
    float: none !important;
    /* Ensure it's visible */
    visibility: visible !important;
    opacity: 1 !important;
  }

  @media screen and (max-width: 749px) {
    .quick-add-modal__skeleton-image {
      width: 300px;
      height: 300px;
      max-width: calc(100% - 20px);
      max-height: calc(100% - 20px);
    }
  }

  .quick-add-modal__skeleton-details {
    flex: 0 0 46.09% !important;
    display: flex !important;
    flex-direction: column;
    justify-content: flex-start;
    height: 100%;
    min-height: 0;
    padding: var(--padding-2xl);
    width: 46.09% !important;
    max-width: 46.09% !important;
    gap: var(--gap-lg);
    /* Ensure skeleton details are always visible */
    visibility: visible !important;
    opacity: 1 !important;

    @media screen and (min-width: 1400px) {
      flex: 0 0 530px !important;
      width: 530px !important;
      max-width: 530px !important;
    }

    @media screen and (max-width: 750px) {
      flex: 1 !important;
      width: 100% !important;
      max-width: 100% !important;
      padding: var(--padding-xl);
    }
  }

  /* Ensure all skeleton elements inside details are visible - override any hiding rules */
  .quick-add-modal__skeleton-details,
  .quick-add-modal__skeleton-details .quick-add-modal__skeleton-line,
  .quick-add-modal__skeleton-details .quick-add-modal__skeleton-title,
  .quick-add-modal__skeleton-details .quick-add-modal__skeleton-price,
  .quick-add-modal__skeleton-details .quick-add-modal__skeleton-line--medium,
  .quick-add-modal__skeleton-details .quick-add-modal__skeleton-line--small,
  .quick-add-modal__skeleton-details .quick-add-modal__skeleton-variants,
  .quick-add-modal__skeleton-details .quick-add-modal__skeleton-variant,
  .quick-add-modal__skeleton-details .quick-add-modal__skeleton-button,
  /* Also target when skeleton-details has product-details class */
  .product-details.quick-add-modal__skeleton-details,
  .product-details.quick-add-modal__skeleton-details .quick-add-modal__skeleton-line,
  .product-details.quick-add-modal__skeleton-details .quick-add-modal__skeleton-title,
  .product-details.quick-add-modal__skeleton-details .quick-add-modal__skeleton-price,
  .product-details.quick-add-modal__skeleton-details .quick-add-modal__skeleton-line--medium,
  .product-details.quick-add-modal__skeleton-details .quick-add-modal__skeleton-line--small,
  .product-details.quick-add-modal__skeleton-details .quick-add-modal__skeleton-variants,
  .product-details.quick-add-modal__skeleton-details .quick-add-modal__skeleton-variant,
  .product-details.quick-add-modal__skeleton-details .quick-add-modal__skeleton-button {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Skeleton details should be flex when it has product-details class */
  .product-details.quick-add-modal__skeleton-details,
  .quick-add-modal__skeleton-details {
    display: flex !important;
  }

  /* Ensure skeleton variants container is flex */
  .quick-add-modal__skeleton-variants {
    display: flex !important;
    flex-direction: column;
  }

  .quick-add-modal__skeleton-line {
    height: 20px;
    background: linear-gradient(
      90deg,
      rgb(var(--color-foreground-rgb) / 0.05) 0%,
      rgb(var(--color-foreground-rgb) / 0.12) 50%,
      rgb(var(--color-foreground-rgb) / 0.05) 100%
    );
    background-size: 200% 100%;
    border-radius: 4px;
    animation: skeleton-loading 1.5s ease-in-out infinite;
  }

  .quick-add-modal__skeleton-title {
    width: 80%;
    height: 28px;
    margin-bottom: var(--gap-xs);
    animation-delay: 0.1s;
  }

  .quick-add-modal__skeleton-price {
    width: 40%;
    height: 24px;
    margin-bottom: var(--gap-md);
    animation-delay: 0.2s;
  }

  .quick-add-modal__skeleton-line--medium {
    width: 90%;
    height: 16px;
    margin-bottom: var(--gap-xs);
    animation-delay: 0.3s;
  }

  .quick-add-modal__skeleton-line--small {
    width: 70%;
    height: 16px;
    margin-bottom: var(--gap-xl);
    animation-delay: 0.4s;
  }

  .quick-add-modal__skeleton-variants {
    display: flex;
    flex-direction: column;
    gap: var(--gap-md);
    margin-bottom: var(--gap-xl);
  }

  .quick-add-modal__skeleton-variant {
    height: 50px;
    background: linear-gradient(
      90deg,
      rgb(var(--color-foreground-rgb) / 0.05) 0%,
      rgb(var(--color-foreground-rgb) / 0.12) 50%,
      rgb(var(--color-foreground-rgb) / 0.05) 100%
    );
    background-size: 200% 100%;
    border-radius: 4px;
    animation: skeleton-loading 1.5s ease-in-out infinite;
  }

  .quick-add-modal__skeleton-variant:nth-child(1) {
    animation-delay: 0.5s;
  }

  .quick-add-modal__skeleton-variant:nth-child(2) {
    animation-delay: 0.6s;
  }

  .quick-add-modal__skeleton-variant:nth-child(3) {
    animation-delay: 0.7s;
  }

  .quick-add-modal__skeleton-button {
    width: 100%;
    height: 50px;
    background: linear-gradient(
      90deg,
      rgb(var(--color-foreground-rgb) / 0.05) 0%,
      rgb(var(--color-foreground-rgb) / 0.12) 50%,
      rgb(var(--color-foreground-rgb) / 0.05) 100%
    );
    background-size: 200% 100%;
    border-radius: 4px;
    margin-top: auto;
    animation: skeleton-loading 1.5s ease-in-out infinite;
    animation-delay: 0.8s;
  }

  @keyframes skeleton-loading {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }

  @media screen and (max-width: 749px) {
    .quick-add-modal__loading-skeleton {
      flex-direction: column;
      min-height: 0;
      height: 100%;
      max-height: 100vh;
    }

    .quick-add-modal__skeleton-media {
      order: 0;
      flex: 0 0 40% !important;
      width: 100% !important;
      max-width: 100% !important;
      height: 40vh;
      max-height: 40vh;
      min-height: 200px;
    }

    .quick-add-modal__skeleton-image {
      width: 250px;
      height: 250px;
      max-width: calc(100% - 40px);
      max-height: calc(100% - 40px);
      min-width: 150px;
      min-height: 150px;
    }

    .quick-add-modal__skeleton-details {
      order: 1;
      flex: 1 !important;
      width: 100% !important;
      max-width: 100% !important;
      padding-inline: var(--padding-xl);
      padding-top: var(--padding-lg);
      padding-bottom: var(--padding-xl);
      max-height: 60vh;
      height: auto;
      min-height: 0;
      overflow-y: auto;
    }
  }
{% endstylesheet %}


{% liquid
  assign block_settings = block.settings
  assign should_show = true
  
  # Check if this is the Highlights accordion by checking the heading
  # If so, check if product has the required tag
  if block_settings.heading == 'Highlights'
    assign product = closest.product
    unless product.tags contains 'custom_fabric_size_care'
      assign should_show = false
    endunless
  endif
%}

{% if should_show %}
<accordion-custom
  {% if block_settings.open_by_default %}
    open-by-default-on-desktop
    open-by-default-on-mobile
  {% endif %}
>
  <details
    class="details"
    data-testid="accordion-details"
    {% if block_settings.open_by_default %}
      open
    {% endif %}
    {{ block.shopify_attributes }}
  >
    <summary class="details__header">
      {% render 'icon-or-image',
        icon: block_settings.icon,
        image_upload: block_settings.image_upload,
        width: block_settings.width,
        class_name: 'details__icon'
      %}
      {{ block_settings.heading }}
      <span class="svg-wrapper icon-plus">
        {{- 'icon-plus.svg' | inline_asset_content -}}
      </span>
      <span class="svg-wrapper icon-minus">
        {{- 'icon-minus.svg' | inline_asset_content -}}
      </span>
    </summary>

    <div class="details-content">
      {% content_for 'blocks' %}
      {% if block_settings.heading == 'Product Features' %}
        {% assign product_features = closest.product.metafields.custom.cb_product_features_icons_with_texts.value %}
        {% if product_features != blank %}
          <div class="product-features-icons">
            {% for feature in product_features %}
              <div class="product-features-icons__item">
                {% if feature.icon != blank %}
                  {{ feature.icon | image_url: width: 28 | image_tag: widths: '28', height: 28, alt: feature.text | escape }}
                {% endif %}
                {% if feature.text != blank %}
                  <div class="product-features-icons__text">{{ feature.text }}</div>
                {% endif %}
              </div>
            {% endfor %}
          </div>
        {% endif %}
        {% assign product_features_card = closest.product.metafields.custom.cb_product_features_card.value %}
        {% if product_features_card != blank %}
          {% if product_features_card.size > 0 %}
            {% for card in product_features_card %}
              <div class="product-features-card">
                {% if card.icon != blank %}
                  <div class="product-features-card__icon-wrap">
                    {% assign card_icon_alt = card.heading | escape %}
                    {{ card.icon | image_url: width: 28 | image_tag: class: 'product-features-card__icon', alt: card_icon_alt }}
                  </div>
                {% endif %}
                <div class="product-features-card__content">
                  {% if card.heading != blank %}
                    <h3 class="product-features-card__heading">{{ card.heading }}</h3>
                  {% endif %}
                  {% if card.description != blank %}
                    <div class="product-features-card__description">{{ card.description }}</div>
                  {% endif %}
                </div>
              </div>
            {% endfor %}
          {% else %}
            <div class="product-features-card">
              {% if product_features_card.icon != blank %}
                <div class="product-features-card__icon-wrap">
                  {% assign single_card_icon_alt = product_features_card.heading | escape %}
                  {{ product_features_card.icon | image_url: width: 28 | image_tag: class: 'product-features-card__icon', alt: single_card_icon_alt }}
                </div>
              {% endif %}
              <div class="product-features-card__content">
                {% if product_features_card.heading != blank %}
                  <h3 class="product-features-card__heading">{{ product_features_card.heading }}</h3>
                {% endif %}
                {% if product_features_card.description != blank %}
                  <div class="product-features-card__description">{{ product_features_card.description }}</div>
                {% endif %}
              </div>
            </div>
          {% endif %}
        {% endif %}
      {% elsif block_settings.heading == 'Material & Care' %}
        {% assign fabric_care = closest.product.metafields.custom.cb_fabric_and_care %}
        {% assign material_care_icon = closest.product.metafields.custom.cb_material_and_care_icon.value %}
        {% if fabric_care != blank %}
          <div class="accordion-row__fabric-care">
            {% if material_care_icon != blank %}
              <img src="{{ material_care_icon | image_url: width: 110 }}" alt="{{ material_care_icon.alt | escape }}" class="accordion-row__fabric-care-image" width="55" height="55" loading="lazy">
            {% endif %}
            <div class="accordion-row__fabric-care-text rte">
              {{ fabric_care | metafield_tag }}
            </div>
          </div>
        {% endif %}
      {% elsif block_settings.heading == 'Delivery Time & Return' %}
        {% assign delivery_return = closest.product.metafields.custom.cb_delivery_time_and_return.value %}
        {% if delivery_return != blank %}
          <div class="accordion-row__delivery-return">
            <div class="accordion-row__delivery-return-row">
              <div class="accordion-row__delivery-return-item">
                <span class="accordion-row__delivery-return-icon">
                  {{- 'truck-duotone.svg' | inline_asset_content -}}
                </span>
                <div class="accordion-row__delivery-return-text-list">
                {% assign free_shipping_list = delivery_return.free_shipping_text.value | default: nil %}
                {% if free_shipping_list != blank %}
                  {% for text in free_shipping_list %}
                    <span class="accordion-row__delivery-return-text">{{ text }}</span>
                  {% endfor %}
                {% endif %}
                </div>
              </div>
              <div class="accordion-row__delivery-return-item">
                <span class="accordion-row__delivery-return-icon">
                  <img src="{{ 'rectangle.svg' | asset_url }}" alt="" width="20" height="20" loading="lazy">
                </span>
                <div class="accordion-row__delivery-return-text-list">
                  {% assign cut_off_time_list = delivery_return.cut_off_time_text.value | default: nil %}
                  {% if cut_off_time_list != blank %}
                    {% for text in cut_off_time_list %}
                      <span class="accordion-row__delivery-return-text">{{ text }}</span>
                    {% endfor %}
                  {% endif %}
                </div>
              </div>
            </div>
            {% if delivery_return.return_policy != blank %}
              <div class="accordion-row__delivery-return-policy rte">
                {{ delivery_return.return_policy | metafield_tag }}
              </div>
            {% endif %}
          </div>
        {% endif %}
      {% elsif block_settings.heading == 'Gift Wrapping' %}
        {% assign gift_wrapping = closest.product.metafields.custom.cb_gift_wrapping.value %}
        {% if gift_wrapping != blank %}
          <div class="accordion-row__gift-wrapping">
            <div class="accordion-row__gift-wrapping-images">
              {% if gift_wrapping.image1 != blank %}
                <div class="accordion-row__gift-wrapping-image-wrap">
                  <img src="{{ gift_wrapping.image1 | image_url: width: 240 }}" alt="" class="accordion-row__gift-wrapping-image" width="120" height="120" loading="lazy">
                </div>
              {% endif %}
              {% if gift_wrapping.image2 != blank %}
                <div class="accordion-row__gift-wrapping-image-wrap">
                  <img src="{{ gift_wrapping.image2 | image_url: width: 240 }}" alt="" class="accordion-row__gift-wrapping-image" width="120" height="120" loading="lazy">
                </div>
              {% endif %}
              {% if gift_wrapping.image3 != blank %}
                <div class="accordion-row__gift-wrapping-image-wrap">
                  <img src="{{ gift_wrapping.image3 | image_url: width: 240 }}" alt="" class="accordion-row__gift-wrapping-image" width="120" height="120" loading="lazy">
                </div>
              {% endif %}
              {% if gift_wrapping.image4 != blank %}
                <div class="accordion-row__gift-wrapping-image-wrap">
                  <img src="{{ gift_wrapping.image4 | image_url: width: 240 }}" alt="" class="accordion-row__gift-wrapping-image" width="120" height="120" loading="lazy">
                </div>
              {% endif %}
            </div>
            {% if gift_wrapping.gift_wrap_text != blank %}
              <div class="accordion-row__gift-wrapping-text rte">
                {{ gift_wrapping.gift_wrap_text | metafield_tag }}
              </div>
            {% endif %}
          </div>
        {% endif %}
      {% elsif block_settings.heading == 'Need Help?' %}
        {% assign need_help = closest.product.metafields.custom.cb_need_help.value %}
        {% if need_help != blank %}
          <div class="accordion-row__need-help">
            {% if need_help.need_help_text != blank %}
              <div class="accordion-row__need-help-text rte">
                {{ need_help.need_help_text | metafield_tag }}
              </div>
            {% endif %}
            {% if need_help.email != blank %}
              <div class="accordion-row__need-help-row">
                <img src="{{ 'email.png' | asset_url }}" alt="" class="accordion-row__need-help-icon" width="18" height="18" loading="lazy">
                <a href="mailto:{{ need_help.email | escape }}" class="accordion-row__need-help-link">{{ need_help.email }}</a>
              </div>
            {% endif %}
            {% if need_help.phone_number != blank %}
              <div class="accordion-row__need-help-row">
                <img src="{{ 'phone-number.png' | asset_url }}" alt="" class="accordion-row__need-help-icon" width="18" height="18" loading="lazy">
                <a href="tel:{{ need_help.phone_number | replace: ' ', '' | escape }}" class="accordion-row__need-help-link accordion-row__need-help-link--phone">{{ need_help.phone_number }}</a>
              </div>
            {% endif %}
          </div>
        {% endif %}
      {% endif %}
    </div>
  </details>
</accordion-custom>
{% endif %}

{% stylesheet %}
  .details__icon {
    height: auto;
    margin-inline-end: var(--margin-xs);
  }

.accordion-details .details__header {
  padding: 16px;
}

  .product-features-icons {
    display: flex;
    flex-wrap: wrap;
    gap: 28px;
    margin-top: 20px;
  }

  .product-features-icons__item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    max-width: 104px;
    text-align: center;
  }

  .product-features-icons__item img {
    width: 28px;
    height: 28px;
  }

  .product-features-icons__text {
    font-family: 'Outfit', sans-serif;
    font-weight: 400;
    font-style: normal;
    font-size: 16px;
    line-height: 130%;
    letter-spacing: 0;
    text-align: center;
  }

  .product-features-card {
    display: flex;
    align-items: center;
    gap: 12px;
    background: #FDF8E7;
    padding: 16px;
    margin-top: 24px;
    border-radius: 4px;
  }

  .product-features-card__icon-wrap {
    flex-shrink: 0;
  }

  .product-features-card__icon {
    width: 28px;
    height: 28px;
    display: block;
  }

  .product-features-card__content {
    display: flex;
    flex-direction: column;
    gap: 7px;
    min-width: 0;
  }

  .product-features-card__heading {
    font-family: 'Outfit', sans-serif;
    font-style: normal;
    font-weight: 500;
    font-size: 18px;
    line-height: 23px;
    color: #1D425A;
    margin: 0;
  }

  .product-features-card__description {
    font-family: 'Outfit', sans-serif;
    font-style: normal;
    font-weight: 300;
    font-size: 16px;
    line-height: 130%;
    color: #1D425A;
    margin: 0;
  }

  .accordion-row__fabric-care {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    flex-direction: column;
  }

  .accordion-row__fabric-care-image {
    width: 55px;
    height: 55px;
    flex-shrink: 0;
    object-fit: contain;
  }

  .accordion-row__fabric-care-text {
    min-width: 0;
  }

  .accordion-row__delivery-return {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .accordion-row__delivery-return-row {
    display: flex;
    flex-wrap: wrap;
    gap: 16px 24px;
    align-items: flex-start;
  }

  .accordion-row__delivery-return-item {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .accordion-row__delivery-return-icon {
    display: inline-flex;
    flex-shrink: 0;
  }

  .accordion-row__delivery-return-text-list {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .accordion-row__delivery-return-text-list span {
    display: block;
  }

  .accordion-row__delivery-return-icon svg {
    width: 20px;
    height: 20px;
  }

  .accordion-row__delivery-return-icon img {
    width: 20px;
    height: 20px;
    object-fit: contain;
  }

  .accordion-row__delivery-return-text {
    font-family: 'Outfit', sans-serif;
    font-size: 14px;
    line-height: 1.3;
  }

  .accordion-row__delivery-return-policy {
    margin-top: 4px;
  }

  .accordion-row__gift-wrapping {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .accordion-row__gift-wrapping-images {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }

  .accordion-row__gift-wrapping-image-wrap {
    flex-shrink: 0;
  }

  .accordion-row__gift-wrapping-image {
    width: 120px;
    height: 120px;
    object-fit: cover;
    display: block;
    border: none;
    border-radius: 0;
  }

  .accordion-row__gift-wrapping-text {
    margin: 0;
  }

  .accordion-row__need-help {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  .accordion-row__need-help-text {
    margin: 0;
    color: #1D425A;
  }

  .accordion-row__need-help-row {
    display: flex;
    align-items: center;
    gap: 9px;
  }

  .accordion-row__need-help-icon {
    width: 18px;
    height: 18px;
    flex-shrink: 0;
    object-fit: contain;
  }

  .accordion-row__need-help-link {
    text-decoration: underline;
    color: #1D425A;
  }

  .accordion-row__need-help-link--phone {
    font-size: 14px;
  }

{% endstylesheet %}

{% schema %}
{
  "name": "t:names.accordion_row",
  "tag": null,
  "blocks": [
    {
      "type": "@theme"
    },
    {
      "type": "@app"
    }
  ],
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "t:settings.heading",
      "default": "t:text_defaults.accordion_heading"
    },
    {
      "type": "checkbox",
      "id": "open_by_default",
      "label": "t:settings.open_row_by_default",
      "default": false
    },
    {
      "type": "header",
      "content": "t:content.icon"
    },
    {
      "type": "select",
      "id": "icon",
      "label": "t:settings.icon",
      "options": [
        {
          "value": "none",
          "label": "t:options.none"
        },
        {
          "value": "apple",
          "label": "t:options.apple"
        },
        {
          "value": "arrow",
          "label": "t:options.arrow"
        },
        {
          "value": "banana",
          "label": "t:options.banana"
        },
        {
          "value": "bottle",
          "label": "t:options.bottle"
        },
        {
          "value": "box",
          "label": "t:options.box"
        },
        {
          "value": "carrot",
          "label": "t:options.carrot"
        },
        {
          "value": "chat_bubble",
          "label": "t:options.chat_bubble"
        },
        {
          "value": "check_box",
          "label": "t:options.check_box"
        },
        {
          "value": "clipboard",
          "label": "t:options.clipboard"
        },
        {
          "value": "dairy",
          "label": "t:options.dairy"
        },
        {
          "value": "dairy_free",
          "label": "t:options.dairy_free"
        },
        {
          "value": "dryer",
          "label": "t:options.dryer"
        },
        {
          "value": "eye",
          "label": "t:options.eye"
        },
        {
          "value": "fire",
          "label": "t:options.fire"
        },
        {
          "value": "gluten_free",
          "label": "t:options.gluten_free"
        },
        {
          "value": "heart",
          "label": "t:options.heart"
        },
        {
          "value": "iron",
          "label": "t:options.iron"
        },
        {
          "value": "leaf",
          "label": "t:options.leaf"
        },
        {
          "value": "leather",
          "label": "t:options.leather"
        },
        {
          "value": "lightning_bolt",
          "label": "t:options.lightning_bolt"
        },
        {
          "value": "lipstick",
          "label": "t:options.lipstick"
        },
        {
          "value": "lock",
          "label": "t:options.lock"
        },
        {
          "value": "map_pin",
          "label": "t:options.map_pin"
        },
        {
          "value": "nut_free",
          "label": "t:options.nut_free"
        },
        {
          "value": "pants",
          "label": "t:options.pants"
        },
        {
          "value": "paw_print",
          "label": "t:options.paw_print"
        },
        {
          "value": "pepper",
          "label": "t:options.pepper"
        },
        {
          "value": "perfume",
          "label": "t:options.perfume"
        },
        {
          "value": "plane",
          "label": "t:options.plane"
        },
        {
          "value": "plant",
          "label": "t:options.plant"
        },
        {
          "value": "price_tag",
          "label": "t:options.price_tag"
        },
        {
          "value": "question_mark",
          "label": "t:options.question_mark"
        },
        {
          "value": "recycle",
          "label": "t:options.recycle"
        },
        {
          "value": "return",
          "label": "t:options.return"
        },
        {
          "value": "ruler",
          "label": "t:options.ruler"
        },
        {
          "value": "serving_dish",
          "label": "t:options.serving_dish"
        },
        {
          "value": "shirt",
          "label": "t:options.shirt"
        },
        {
          "value": "shoe",
          "label": "t:options.shoe"
        },
        {
          "value": "silhouette",
          "label": "t:options.silhouette"
        },
        {
          "value": "bluesky",
          "label": "t:options.social_bluesky"
        },
        {
          "value": "facebook",
          "label": "t:options.social_facebook"
        },
        {
          "value": "instagram",
          "label": "t:options.social_instagram"
        },
        {
          "value": "linkedin",
          "label": "t:options.social_linkedin"
        },
        {
          "value": "pinterest",
          "label": "t:options.social_pinterest"
        },
        {
          "value": "snapchat",
          "label": "t:options.social_snapchat"
        },
        {
          "value": "spotify",
          "label": "t:options.social_spotify"
        },
        {
          "value": "threads",
          "label": "t:options.social_threads"
        },
        {
          "value": "tiktok",
          "label": "t:options.social_tiktok"
        },
        {
          "value": "tumblr",
          "label": "t:options.social_tumblr"
        },
        {
          "value": "twitter",
          "label": "t:options.social_twitter"
        },
        {
          "value": "vimeo",
          "label": "t:options.social_vimeo"
        },
        {
          "value": "youtube",
          "label": "t:options.social_youtube"
        },
        {
          "value": "whatsapp",
          "label": "t:options.social_whatsapp"
        },
        {
          "value": "snowflake",
          "label": "t:options.snowflake"
        },
        {
          "value": "star",
          "label": "t:options.star"
        },
        {
          "value": "stopwatch",
          "label": "t:options.stopwatch"
        },
        {
          "value": "truck",
          "label": "t:options.truck"
        },
        {
          "value": "washing",
          "label": "t:options.washing"
        }
      ],
      "default": "none"
    },
    {
      "type": "image_picker",
      "id": "image_upload",
      "label": "t:settings.image_icon"
    },
    {
      "type": "range",
      "id": "width",
      "label": "t:settings.width",
      "min": 12,
      "max": 200,
      "step": 2,
      "unit": "px",
      "default": 20
    }
  ],
  "presets": [
    {
      "name": "t:names.accordion_row",
      "blocks": {
        "text-1": {
          "type": "text",
          "settings": {
            "text": "t:html_defaults.work_quickly_to_ship",
            "width": "100%"
          }
        }
      },
      "block_order": ["text-1"],
      "settings": {
        "heading": "t:text_defaults.when_will_order_arrive"
      }
    }
  ]
}
{% endschema %}

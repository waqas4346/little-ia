 
{% liquid
  assign block_settings = block.settings
  assign product = closest.product
  if request.visual_preview_mode and product == blank
    assign product = collections.all.products.first
  endif

  assign variant = closest.product.selected_or_first_available_variant
  assign inventory_quantity = variant.inventory_quantity
  assign inventory_policy = variant.inventory_policy

  if variant.inventory_management == 'shopify'
    assign inventory_managed = true
  endif

  assign can_add_to_cart = false
  assign add_to_cart_text = 'products.product.unavailable' | t

  if variant
    if variant.quantity_rule.min > variant.inventory_quantity and inventory_managed and inventory_policy == 'deny'
      assign quantity_rule_soldout = true
    endif

    if variant.available
      assign can_add_to_cart = true
      assign add_to_cart_text = 'products.product.add_to_cart' | t
    elsif inventory_managed and inventory_quantity <= 0 and inventory_policy == 'deny' or quantity_rule_soldout
      assign can_add_to_cart = false
      assign add_to_cart_text = 'products.product.sold_out' | t
    else
      assign can_add_to_cart = false
      assign add_to_cart_text = 'products.product.unavailable' | t
    endif
  endif
%}

<span
  class="buy-buttons-block buy-buttons-block--{{ block.id }}"
  {{ block.shopify_attributes }}
>
  {%- if product != blank -%}
    {%- assign product_form_id = 'BuyButtons-ProductForm-' | append: section.id -%}
    <product-form-component
      data-section-id="{{ section.id }}"
      data-product-id="{{ product.id }}"
      data-product-url="{{ product.url }}"
      on:submit="/handleSubmit"
      data-quantity-default="{% if product.selected_or_first_available_variant.quantity_rule.min %}{{ product.selected_or_first_available_variant.quantity_rule.min }}{% else %}1{% endif %}"
      data-quantity-error-max="{{ 'products.product.quantity_error_max' | t }}"
    >
      <div
        class="visually-hidden"
        aria-live="assertive"
        role="status"
        aria-atomic="true"
        ref="liveRegion"
      ></div>
      {%- form 'product', product, id: product_form_id, data-type: 'add-to-cart-form' -%}
        <input
          type="hidden"
          name="id"
          ref="variantId"
          value="{{ product.selected_or_first_available_variant.id }}"
        >
        {%- if block_settings.gift_card_form and product.gift_card? -%}
          {%- render 'gift-card-recipient-form', product: product, form: form, section: section, block: block -%}
        {%- endif -%}
        <div
          class="product-form-buttons spacing-style{% if block_settings.stacking %} product-form-buttons--stacked{% endif %}"
          style="{% render 'spacing-style', settings: block_settings %}"
          ref="productFormButtons"
        >
          {%- liquid
            assign has_quantity_rules = false
            if variant.quantity_rule.min > 1 or variant.quantity_rule.increment > 1 or variant.quantity_rule.max != null
              assign has_quantity_rules = true
            endif
          -%}

          {%- comment -%} Personalise It Button {%- endcomment -%}
          <button
            type="button"
            class="personalise-button button-unstyled"
            data-personalise-button
          >
            <span class="personalise-button__icon">
             <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
              <rect width="18" height="18" fill="url(#pattern0_860_15113)"/>
              <defs>
              <pattern id="pattern0_860_15113" patternContentUnits="objectBoundingBox" width="1" height="1">
              <use xlink:href="#image0_860_15113" transform="scale(0.00195312)"/>
              </pattern>
              <image id="image0_860_15113" width="512" height="512" preserveAspectRatio="none" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAACAKADAAQAAAABAAACAAAAAAAL+LWFAAA1Z0lEQVR4Ae3de5Al110f8O47s9bLxvghEBiHOLEpDDYQB6qAGIKy0i6Q2Cn+wHkXUKRwSbKMdi0rwRWSrUoVD1nyYq9WKrsgVP4gIUrlDwIxXj28YAgE2SuMQ0yBk/CynWCIJVvoYe3u7fRdaczO7NyZfpzuPuf0Z6tcM/fe7tPnfH4tf3+372OKwj8CBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIEAgpEAZcjBjESBAgMA8BY799OnLP/PU8kWbZ4vLl5vnvrA4XzxelJtPblxx2adv//7XPjZPlbhXrQGIuz5mR4AAgegEbn7Xe7/gss0D37Ksim+rQ+Trqqr4iqIsXlpPdNdMqe/8f/Vjv1cVxW+XVfUrG8sDp29/87Ufj25hM5vQrsWamYHlEiBAgMA+Are+/dRVy6vK7yqq8h/Vm15X/29zn132fLhuBj6yKMqf2Ti/8e80A3tSDfagBmAwWgMTIEAgfYH62f7VBzYO3FQ/uX9zUVQvGGBFy/q6wXurcvGvj99w8KEBxjfkGgENwBoYdxMgQGDOAqtn/OevXPyLOiR+sHa4YiSLn6vK8ujxG6/73yMdb9aH0QDMuvwWT4AAgUsFjt593+uLZXmifmb+ly59dPB7nqzK6sce33jhj77njV9/dvCjzfgAGoAZF9/SCRAgcLFAfbn/sgMbm7fXl/tvru+fOh8+WF8N+PuuBlxcobC/T13gsKsxGgECBAh0ErjtxH1fem5R/ny982s6DTDITuUjVVm8oW4CHhhk+JkPqgGY+Qlg+QQIEDhy9wN/pf543qla4uXRaVTF01VRfs/xN133s9HNLfEJLRKfv+kTIECAQA+BIyfuf3Ud/r9eDxFf+K/WVRbPKcvqZ46efOCNPZZp110ENAC7oLiLAAECcxC45eT9rywXxX31Wr8o8vXWWVXdU785sf44on+hBLwEEErSOAQIEEhIYBX+daq+v57yNQlNu341oLr5HTceOpnQnKOdqgYg2tKYGAECBIYRSDT8tzA0AVsSPX9qAHoC2p0AAQIpCSQe/lvUmoAtiR4/NQA98OxKgACBlAQyCf8tck3AlkTHnxqAjnB2I0CAQEoCmYX/Fr0mYEuiw08NQAc0uxAgQCAlgUzDf6sEmoAtiZY/NQAtwWxOgACBlAQyD/+tUmgCtiRa/NQAtMCyKQECBFISmEn4b5VEE7Al0fCnBqAhlM0IECCQksDMwn+rNJqALYkGPzUADZBsQoAAgZQEZhr+WyXSBGxJ7PNTA7APkIcJECCQksDMw3+rVJqALYk9fmoA9sDxEAECBFISEP7bqqUJ2MZx6Q0NwKUm7iFAgEByAsJ/15JpAnZleeZODcAeOB4iQIBACgLCf88qaQLW8GgA1sC4mwABAikICP9GVaqqonjz8Zuuv6vR1jPZSAMwk0JbJgEC+QkI/1Y11QTs4NIA7ABxkwABAikICP9OVdIEXMSmAbgIw68ECBBIQUD496qSJuBZPg1Ar/PIzgQIEBhXQPgH8dYE1IwagCDnkkEIECAwvIDwD2o8+yZAAxD0fDIYAQIEhhEQ/oO4zroJ0AAMck4ZlAABAuEEhH84y11Gmm0ToAHY5WxwFwECBGIREP6jVGKWTYAGYJRzy0EIECDQXkD4tzfrscfsmgANQI+zxa4ECBAYSkD4DyW757izagI0AHueCx4kQIDA+ALCf3zzi444myZAA3BR1f1KgACBqQWE/9QVuHD8WTQBGoAozjWTIECAQFEI/6jOguybAA1AVOebyRAgMFcB4R9l5bNuAjQAUZ5zJkWAwJwEhH/U1c62CVhEzW5yBAgQyFzgyIn7X13/H/Ev18u8JvOlprq8sn6m/K6jdz3w5lQXsG7eGoB1Mu4nQIDAwAKrZ/7lorivPszVAx/K8P0EyqKs3nn07gd+qN8wce3tJYC46mE2BAjMRMBl/0QLXZZve8eN1/1oorPfNm0NwDYONwgQIDC8gPAf3njQI2TSBGgABj1LDE6AAIHtAsJ/u0eqt+rw/KE7b7r+x1Kd/2reGoCUq2fuBAgkJSD8kyrXvpNNvQnQAOxbYhsQIECgv4Dw728Y4wgpNwEagBjPKHMiQCArAeGfVTkvWUyqTYAG4JJSuoMAAQLhBIR/OMuYR0qxCdAAxHxGmRsBAkkLCP+ky9d68qk1ARqA1iW2AwECBPYXEP77G+W4RUpNgAYgxzPQmggQmFRA+E/KP/nBU2kCNACTnyomQIBATgLCP6dqdl9LCk2ABqB7fe1JgACBbQLCfxvH7G/E3gRoAGZ/igIgQCCEgPAPoZjfGDE3ARqA/M43KyJAYGQB4T8yeGKHi7UJ0AAkdiKZLgECcQkI/7jqEetsYmwCNACxni3mRYBA9ALCP/oSRTXB2JoADUBUp4fJECCQioDwT6VScc0zpiZgEReN2RAgQCANgfr/PH+knuk1aczWLGMRqOrz5uhd998Sw3w0ADFUwRwIEEhOYPHE8h9XZfFLyU3chKcWKIuyOH707vv+2fQTmXoGjk+AAIFEBW59+6mrzl+1+IWyKr4t0SWY9pQCZfXP33HjoR+fagreAzCVvOMSIJCFgCYgizJOt4gJmwANwHRld2QCBDIR0ARkUsipljFRE6ABmKrgjkuAQFYCmoCsyjn+YiZoAjQA45fZEQkQyFRAE5BpYcda1shNgAZgrMI6DgECsxDQBMyizMMtcsQmQAMwXBmNTIDATAU0ATMtfKhlj9QEaABCFcw4BAgQuEhAE3ARhl/bC4zQBGgA2pfFHgQIEGgkoAloxGSj3QXq75mqjtx506F37v5w/3s1AP0NjUCAAIG1ApqAtTQe2F9g0CZAA7B/AWxBgACBXgK3/dSvPu/cU0++tx7ktb0GsvMcBaqyLH7wzhuvPxF68f4WQGhR4xEgQGCHwO3f/9rH6r8d8O3+dsAOGDebCJRVVbzz6Mn7vrfJxm22cQWgjZZtCRAg0EPAlYAeeHY9Wy6L19158/WnQlG4AhBK0jgECBDYR8CVgH2APLyXwIFqUfzsrSdOvWyvjdo8pgFoo2VbAgQI9BS4462HH994fPl3vBzQE3Keu3/hcrH4D8fuvfc5IZavAQihaAwCBAi0EFg1AQcuu+L19d+F/68tdrMpgZXAN3z2T1/wthAU3gMQQtEYBAgQ6CDgI4Id0OyyEnhqsVx+1R03H/79PhyuAPTRsy8BAgR6CLgS0ANv3rtevlxs3NmXQAPQV9D+BAgQ6CFw4Y2Bjy8Pe09AD8RZ7lp91y13PfiaPkvXAPTRsy8BAgQCCHhjYADEGQ6xKJe39lm29wD00bMvAQIEAgpc+J6Azz35i0VV/I2AwxoqX4Fzm+c3X3b7m6/9eJclugLQRc0+BAgQGEDAywEDoOY95ObZjbN/r+sSNQBd5exHgACBAQS8HDAAasZDlsXiH3RdnpcAusrZjwABAgMKeDlgQNzMht5cVi+5/eZDn2y7LFcA2orZngCBaAWO3PX+rz5yz4MviXaCLSa2ejlg87IrvsOXBbVAm+mmZ8vFt3ZZugagi5p9CBCITuDWe069qizPny6Xy1/SBERXHhMaUGBRVt/SZXgNQBc1+xAgEJXAW06c+srlcnF/Pamr6/+9fNUE3Pau018W1SQ7TsYbAzvCzWi3qihf1WW5GoAuavYhQCAagVX4V4vF6XpC11w0qZef2zh3OpcmwBsDL6qsX3cRqF6xy5373uVNgPsS2YAAgVgFVpf962f+76/nt3rmf8m/qig+ViwW1x6/4eAnLnkwwTu8MTDBoo0z5erPN5967nve+Lon2hzOFYA2WrYlQCAagR2X/XedV/0M5xVeDtiVxp15CZRXFgee33ZJGoC2YrYnQGBygTWX/dfNy8sB62Tcn43A4uzm89ouRgPQVsz2BAhMKrC67F+/5v+BehIXv+a/35xefnbj3Ptz+XSAvyK4X7nn93hVVZe1XbUGoK2Y7QkQmEygyWX/dZPzcsA6GfdnIbBRPt52HRqAtmK2J0BgEoGWl/3XzdHLAetk3J+0wLlzTz/WdgEagLZitidAYHSBjpf9183TywHrZNyfqsC5z132RY+2nbwGoK2Y7QkQGFWgz2X/dRNdvRxQLJenc3lPgC8LWlfp2dz/B+9549efbbtaDUBbMdsTIDCaQOBn/tvmnVsT4I2B28o7qxtVUX2sy4I1AF3U7EOAwOACQzzz3znp3JoAVwJ2Vnget+vz+ENdVqoB6KJmHwIEBhUI9Ia/RnPMrQnwtcGNyp7VRmW1+JUuC9IAdFGzDwECgwkMedl/3aRzbAIOXHbF6/0p4XUVz+j+qnj6yXLj17usSAPQRc0+BAgMIjDGZf91E8+tCfBywLpKZ3f/++6+6do/77IqDUAXNfsQIBBcYMzL/usmn1sTsPVyQL3eX163ZvenLVD/KeB/33UFGoCucvYjQCCYwBSX/ddNPscmYPPyK17n5YB1FU/5/vKRjSfP/3zXFWgAusrZjwCBIAJTXvZft4DcmoCtlwPq9boSsK7oCd5fltXJ1VWerlPXAHSVsx8BAr0FYnrmv3MxuTUBq6C4cCWgqH5t51rdTlLgybJcnugzcw1AHz37EiDQWSDGZ/47F5NbE3DhSsAT1aF6na4E7Cx2crerO+644fCn+kxbA9BHz74ECHQSiOENf00nnlsTsLoSsHhi+bfr9WsCmp4E8W33x4snqh/vO6363PaPAAEC4wmsLvsvl4v310e8eryj9j9SVRQfKxaLa4/fcPAT/UebfoTbfupXn3fuqSfeVxTlN08/GzNoJVBWf/cdNx76z6322WVjVwB2QXEXAQLDCKRw2X/dynO7EuDlgHWVjv7+u0KE/2qVGoDoa22CBPIQiPkNf02Fc2sCvDGwaeXj2K4+/z78BVduvjXUbDQAoSSNQ4DAWoGUn/nvXFRuTYArATsrHOft+i/+fbwqlq8/9n3XPhVqhvW57B8BAgSGEzhy4v5Xl4viwfoISb3mv5+I9wTsJ+TxYAJV8ellWbz2J266/neCjVkP5ApASE1jESCwTWD1zL8O//vqO7MK/9UiXQnYVmo3hhN4tNpYfEfo8F9N1xWA4YpmZAKzFkjpo359CpXblYBb337qquWVi/9Sm/zNPi72DSLwaLVYHK4/efJQkNF2DKIB2AHiJgEC/QXmEv5bUpqALQk/AwoMGv6reWoAAlbLUAQIFMXcwn+r5pqALQk/AwgMHv6rOWoAAlTKEAQIPCMw1/Dfqr8mYEvCzx4Co4T/an4agB5VsisBAn8hMPfw35LQBGxJ+NlBYLTwX81NA9ChQnYhQGC7gPDf7qEJ2O7hViOBUcN/NSMNQKO62IgAgXUCwn93GU3A7i7u3VVg9PBfzUIDsGst3EmAQBMB4b+3kiZgbx+PXhCYJPxXR9YAOAMJEOgkIPybsWkCmjnNdKvJwn/lrQGY6Vln2QT6CAj/dnqagHZeM9l60vBfGWsAZnKmWSaBUALCv5ukJqCbW6Z7TR7+K1cNQKZnl2URGEJA+PdT1QT088tk7yjCf2WpAcjkjLIMAkMLCP8wwpqAMI6JjhJN+K/8NACJnkWmTWBMAeEfVlsTENYzkdGiCv+VmQYgkTPHNAlMJSD8h5HXBAzjGumo0YX/ykkDEOnZYloEYhAQ/sNWQRMwrG8ko0cZ/isbDUAkZ4hpEIhN4JaT979yURTvr+d1TWxzy2k+moCcqnnJWqIN/9VMNQCX1MsdBAgI/3HPAU3AuN4jHS3q8F8ZaABGOhMchkAqAsJ/mkppAqZxH+io0Yf/at0agIGqb1gCKQoI/2mrpgmY1j/Q0ZMI/9VaNQCBKm4YAqkLCP84KqgJiKMOHWeRTPiv1qcB6FhluxHISUD4x1VNTUBc9Wg4m6TCf7UmDUDDytqMQK4Cwj/OymoC4qzLmlklF/6rdWgA1lTT3QTmICD8465ynk3AxnuLovrWuOVbzS7J8F+tUAPQqs42JpCPgPBPo5aagKjrlGz4r1Tr7/nwjwCBuQkI/3QqXj9Le0WxXJ4+cs+DL0ln1utnesdbDz++eOL8d9bPPz+wfqskHnm0LMpDx284+FASs91lkq4A7ILiLgI5Cwj/NKvrSkBUdbsQ/nfedN0Ho5pVy8loAFqC2ZxAygLCP+Xq1a+cF8XHisXi2vpZ5yfSXskzs7/17aeuWl6Z3HsCsgj/VQU0ADn8V2QNBBoICP8GSAlsogmYtEjZhP9KUQMw6bnk4ATGERD+4ziPdRRNwFjS246TVfivVqYB2FZfNwjkJyD886vpakWagFHrml34r/Q0AKOeQw5GYFwB4T+u99hH0wSMIp5l+K/kNACjnD8OQmB8AeE/vvkUR9QEDKqebfiv1DQAg547BicwjYDwn8Z9qqNqAgaRzzr8V2IagEHOG4MSmE5A+E9nP+WRNQFB9bMP/5WWBiDoOWMwAtMKCP9p/ac+uiYgSAVmEf4rKQ1AkPPFIASmFxD+09cghhloAnpVYTbhv1LSAPQ6V+xMIA4B4R9HHWKZhSagUyVmFf4rIQ1Ap/PETgTiERD+8dQipploAlpVY3bhv9LRALQ6R2xMIC4B4R9XPWKbjSagUUVmGf4rGQ1Ao/PDRgTiExD+8dUkxhlpAvasymzDf6WiAdjz3PAggTgFhH+cdYl1VpqAXSsz6/BfiWgAdj0v3EkgXgHhH29tYp6ZJmBbdWYf/isNDcC2c8INAnELCP+46xP77DQBFyok/J89UTUAsf8Xa34EnhUQ/k6FEAIzbwKE/0UnkQbgIgy/EohVQPjHWpk05zXTJkD47zhdNQA7QNwkEJuA8I+tInnMZ2ZNgPDf5bTVAOyC4i4CsQgI/1gqkec8cmsCbn7Xe7/gwMaBU3W1vvGiign/izAu/lUDcLGG3wlEJCD8IypGxlPJvAkQ/nucuxqAPXA8RGAqgSMn7n91uSgerI9/9VRzcNz5CNRB8Lsby+pv3X7zoU/msOrVlYDNjc2fXZTVD9954+EzOaxpiDVoAIZQNSaBHgKe+ffAs2tngdyuBHSGmNGOGoAZFdtS4xcQ/vHXKOcZagJyru6la9MAXGriHgKTCAj/SdgddIeAJmAHSMY3NQAZF9fS0hEQ/unUag4z1QTMocq+CngeVbbKqAWEf9Tlme3kNAH5l94VgPxrbIURCwj/iItjaoUmIO+TQAOQd32tLmIB4R9xcUzt8wKagM9TZPeLBiC7klpQCgLCP4UqmeOWgCZgSyKvnxqAvOppNQkICP8EimSKlwhoAi4hSf4ODUDyJbSAlASEf0rVMtedApqAnSJp39YApF0/s09IQPgnVCxTXSugCVhLk9wDGoDkSmbCKQoI/xSrZs7rBDQB62TSul8DkFa9zDZBAeGfYNFMeV8BTcC+RNFvoAGIvkQmmLKA8E+5eua+n4AmYD+huB/XAMRdH7NLWED4J1w8U28soAloTBXdhovoZmRCBDIQEP4ZFNESGgnUzyJfUSyXp287cd+XNtrBRtEIuAIQTSlMJBcB4Z9LJa2jpcDvbS6ra2+/+dAnW+5n84kENAATwTtsngLCP8+6WlVjAU1AY6rpN9QATF8DM8hEQPhnUkjL6CugCegrONL+GoCRoB0mbwHhn3d9ra61gCagNdn4O2gAxjd3xMwEhH9mBbWcUAKagFCSA42jARgI1rDzEBD+86izVXYW0AR0pht+Rw3A8MaOkKmA8M+0sJYVWkATEFo00HgagECQhpmXgPCfV72ttreAJqA3YfgBNADhTY2YuYDwz7zAljeUgCZgKNmO42oAOsLZbZ4Cwn+edbfqYAKagGCU/QfyVcD9DY0wE4EjJ+5/df0fzC/Xy71mJku2TAKBBcqrz22WXxx4UMN1FNjsuJ/dCMxKYPXMv75cdl+96KtntXCLJRBO4NH6v6HDd95w/W+GG9JIfQS8BNBHz76zEHDZfxZltshhBerwLw/dedN1Hxz2MEZvI6ABaKNl29kJCP/ZldyCwwsI//CmQUbUAARhNEiOAsI/x6pa08gCj1aLxeHjNxx8aOTjOlwDAQ1AAySbzE9A+M+v5lYcXED4BycNO6AGIKyn0TIQEP4ZFNESphYQ/lNXoMHxNQANkGwyHwHhP59aW+lgAsJ/MNqwA2sAwnoaLWEB4Z9w8Uw9FgHhH0slGsxDA9AAySb5Cwj//GtshYMLfKZ+w98hb/gb3DnYATQAwSgNlKqA8E+1cuYdkYDwj6gYTaeiAWgqZbssBYR/lmW1qHEFhP+43sGOpgEIRmmg1ASEf2oVM98IBYR/hEVpOiV/DKiplO2yEvCHfbIqp8VMIlA+UpbLg17znwQ/yEFdAQjCaJCUBDzzT6la5hqpgK/3jbQwbaalAWijZdvkBYR/8iW0gOkFhP/0NQgyAw1AEEaDpCAg/FOokjlGLiD8Iy9Qm+lpANpo2TZZAeGfbOlMPB4B4R9PLYLMRAMQhNEgMQsI/5irY26JCAj/RArVZpoagDZatk1OQPgnVzITjk9A+MdXkyAz0gAEYTRIjALCP8aqmFNiAsI/sYK1ma4GoI2WbZMREP7JlMpE4xUQ/vHWJsjMNABBGA0Sk4Dwj6ka5pKogPBPtHBtpq0BaKNl2+gFhH/0JTLB+AWEf/w1CjJDDUAQRoPEICD8Y6iCOSQuIPwTL2Cb6WsA2mjZNloB4R9taUwsHQHhn06tgsxUAxCE0SBTCgj/KfUdOxMB4Z9JIdssQwPQRsu20QkI/+hKYkLpCQj/9GoWZMYagCCMBplCQPhPoe6YmQkI/8wK2mY5GoA2WraNRkD4R1MKE0lXQPinW7sgM9cABGE0yJgCwn9MbcfKVED4Z1rYNsvSALTRsu3kAsJ/8hKYQPoCwj/9GgZZgQYgCKNBxhAQ/mMoO0bmAsI/8wK3WZ4GoI2WbScTEP6T0TtwPgLCP59aBlmJBiAIo0GGFBD+Q+oaeyYCwn8mhW6zTA1AGy3bji4g/Ecnd8D8BIR/fjUNsiINQBBGgwwhIPyHUDXmzASE/8wK3ma5GoA2WrYdTUD4j0btQPkKCP98axtkZRqAIIwGCSkg/ENqGmumAsJ/poVvs2wNQBst2w4uIPwHJ3aA/AWEf/41DrJCDUAQRoOEEBD+IRSNMXMB4T/zE6DN8jUAbbRsO5iA8B+M1sDzERD+86l1kJVqAIIwGqSPgPDvo2dfAhcEhL8TobWABqA1mR1CCgj/kJrGmqmA8J9p4fsuWwPQV9D+nQWEf2c6OxLYEhD+WxJ+thbQALQms0MIAeEfQtEYMxcQ/jM/AfouXwPQV9D+rQWEf2syOxDYKfBotVgcPn7DwYd2PuA2gaYCGoCmUrYLIiD8gzAaZN4Cwn/e9Q+2eg1AMEoD7Scg/PcT8jiBfQWE/75ENmgqoAFoKmW7XgLCvxefnQmsBIS/8yCogAYgKKfBdhMQ/rupuI9AKwHh34rLxk0ENABNlGzTWUD4d6azI4EtAeG/JeFnUAENQFBOg10sIPwv1vA7gU4Cwr8Tm52aCGgAmijZprWA8G9NZgcCOwWE/04Rt4MKaACCchpsJSD8nQcEegsI/96EBthPQAOwn5DHWwkI/1ZcNiawm4Dw303FfcEFNADBSec7oPCfb+2tPJiA8A9GaaD9BDQA+wl5vJGA8G/EZCMCewkI/710PBZcQAMQnHR+Awr/+dXcioMLCP/gpAbcT0ADsJ+Qx/cUEP578niQQBMB4d9EyTbBBTQAwUnnM6Dwn0+trXQwAeE/GK2B9xPQAOwn5PFdBYT/rizuJNBGQPi30bJtcAENQHDS/AcU/vnX2AoHFxD+gxM7wH4CGoD9hDy+TUD4b+Nwg0AXAeHfRc0+wQU0AMFJ8x1Q+OdbWysbTUD4j0btQPsJaAD2E/L4BQHh70Qg0FtA+PcmNEBIAQ1ASM1MxxL+mRbWssYUEP5jajtWIwENQCOm+W4k/OdbeysPJiD8g1EaKKSABiCkZmZjCf/MCmo5UwgI/ynUHbORgAagEdP8NhL+86u5FQcXEP7BSQ0YUkADEFIzk7GEfyaFtIwpBYT/lPqO3UhAA9CIaT4bCf/51NpKBxMQ/oPRGjikgAYgpGbiYwn/xAto+jEICP8YqmAOjQQ0AI2Y8t9I+OdfYyscXED4D07sACEFNAAhNRMdS/gnWjjTjklA+MdUDXNpJKABaMSU70bCP9/aWtloAsJ/NGoHCimgAQipmdhYwj+xgplujALCP8aqmFMjAQ1AI6b8NhL++dXUikYXEP6jkztgSAENQEjNRMYS/okUyjRjFhD+MVfH3BoJaAAaMeWzkfDPp5ZWMpmA8J+M3oFDCmgAQmpGPpbwj7xAppeCgPBPoUrm2EhAA9CIKf2NhH/6NbSCyQWE/+QlMIGQAhqAkJqRjiX8Iy2MaaUkIPxTqpa5NhLQADRiSncj4Z9u7cw8GgHhH00pTCSkgAYgpGZkYwn/yApiOikKCP8Uq2bOjQQ2Gm1lo+QEbr37ga+pJ/1L9f++KLnJmzCBOASEfxx1MIuBBFwBGAh2ymFX4b+sqgfrObx4ynk4NoGEBYR/wsUz9WYCGoBmTslsJfyTKZWJxisg/OOtjZkFFNAABMSceijhP3UFHD8DAeGfQREtoZmABqCZU/RbCf/oS2SC8QsI//hrZIYBBTQAATGnGkr4TyXvuBkJCP+MimkpzQQ0AM2cot1K+EdbGhNLR0D4p1MrMw0ooAEIiDn2UMJ/bHHHy1BA+GdYVEtqJqABaOYU3VbCP7qSmFB6AsI/vZqZcUABDUBAzLGGEv5jSTtOxgLCP+PiWlozAQ1AM6dothL+0ZTCRNIVEP7p1s7MAwpoAAJiDj2U8B9a2PgzEBD+MyiyJTYT0AA0c5p8K+E/eQlMIH0B4Z9+Da0goIAGICDmUEMJ/6FkjTsjAeE/o2JbajMBDUAzp8m2Ev6T0TtwPgLCP59aWklAAQ1AQMzQQwn/0KLGm6GA8J9h0S25mYAGoJnT6FsJ/9HJHTA/AeGfX02tKKCABiAgZqihhH8oSePMWED4z7j4lt5MQAPQzGm0rYT/aNQOlK+A8M+3tlYWUEADEBCz71DCv6+g/QkUwt9JQKChgAagIdTQmwn/oYWNPwMB4T+DIltiOAENQDjLziMJ/850diSwJSD8tyT8JNBQQAPQEGqozYT/ULLGnZGA8J9RsS01nIAGIJxl65GEf2syOxDYKSD8d4q4TaChgAagIVTozYR/aFHjzVBA+M+w6JYcTkADEM6y8UjCvzGVDQmsE/hMtVgcOn7DwYfWbeB+AgT2FtAA7O0T/FHhH5zUgPMTEP7zq7kVDyCgARgAdd2Qwn+djPsJNBYQ/o2pbEhgbwENwN4+wR4V/sEoDTRfAeE/39pb+QACGoABUHcOKfx3irhNoLWA8G9NZgcCewtoAPb26f2o8O9NaAACwt85QGAAAQ3AAKhbQwr/LQk/CXQWEP6d6exIYG8BDcDePp0fFf6d6exIYEtA+G9J+ElgAAENwACown8AVEPOTUD4z63i1ju6gAYgMLnwDwxquDkKCP85Vt2aRxfQAAQkF/4BMQ01VwHhP9fKW/foAhqAQOTCPxCkYeYsIPznXH1rH11AAxCAXPgHQDTE3AWE/9zPAOsfXUAD0JNc+PcEtDuBohD+zgICEwhoAHqgC/8eeHYl8IyA8HcmEJhIQAPQEV74d4SzG4G/EBD+f2HhNwKjC2gAOpAL/w5odiGwXUD4b/dwi8DoAhqAluTCvyWYzQlcKiD8LzVxD4HRBTQALciFfwssmxLYXUD47+7iXgKjC2gAGpIL/4ZQNiOwXkD4r7fxCIHRBTQADciFfwMkmxDYW0D47+3jUQKjC2gA9iEX/vsAeZjA/gLCf38jWxAYXUADsAe58N8Dx0MEmgkI/2ZOtiIwuoAGYA258F8D424CzQWEf3MrWxIYXUADsAu58N8FxV0E2gkI/3ZetiYwuoAGYAe58N8B4iaB9gLCv72ZPQiMLqABuIhc+F+E4VcC3QSEfzc3exEYXUAD8Cy58B/93HPA/ASEf341taKMBTQAdXGFf8ZnuKWNJSD8x5J2HAKBBGbfAAj/QGeSYeYsIPznXH1rT1Zg1g2A8E/2vDXxeASEfzy1MBMCrQRm2wAI/1bniY0J7CYg/HdTcR+BRARm2QAI/0TOTtOMWUD4x1wdcyPQQGB2DYDwb3BW2ITA3gLCf28fjxJIQmBWDYDwT+KcNMm4BYR/3PUxOwKNBWbTAAj/xueEDQmsExD+62TcTyBBgVk0AMI/wTPTlGMTEP6xVcR8CPQUyL4BEP49zxC7EygK4e8sIJChQNYNgPDP8Iy1pLEFhP/Y4o5HYCSBbBsA4T/SGeQwOQsI/5yra22zF8iyARD+sz+vAfQXEP79DY1AIGqB7BoA4R/1+WZyaQgI/zTqZJYEeglk1QAI/17ngp0JrASEv/OAwEwEsmkAhP9MzljLHFJA+A+pa2wCkQlk0QAI/8jOKtNJUUD4p1g1cybQQyD5BkD496i+XQk8IyD8nQkEZiiQdAMg/Gd4xlpyaAHhH1rUeAQSEUi2ARD+iZxhphmzgPCPuTrmRmBggSQbAOE/8Flh+DkICP85VNkaCewhkFwDIPz3qKaHCDQTEP7NnGxFIGuBpBoA4Z/1uWhx4wgI/3GcHYVA9ALJNADCP/pzyQTjFxD+8dfIDAmMJpBEAyD8RzsfHChfAeGfb22tjEAngegbAOHfqa52InCxgPC/WMPvBAhcEIi6ARD+zlICvQWEf29CAxDIUyDaBkD453nCWdWoAsJ/VG4HI5CWwCLG6d56z6lXLavqwXpuL45xfuZEIAGBR8uivP74DQcfSmCupkiAwAQC0V0BuOXd7/uSxdmN/1aUxV+awMMhCeQg4Jl/DlW0BgIDC0R1BeDYT5++fHFu4xeE/8BVN3zOAp7551xdayMQUGAz4Fi9h/rsE2ffVhTla3oPZAAC8xRYPfM//I4bDn5wnsu3agIE2ghE8xLALSfvf+WiKj5cP/t/TpsF2JYAgQsCq2f+h+686Trh74QgQKCRQDRXABZF+bairIR/o7LZiMA2Ac/8t3G4QYBAE4EorgDcduK+Lz1Xlr/v2X+TktmGwDYBb/jbxuEGAQJNBaJ4E+C5RfkPhX/TktmOwOcFvOHv8xR+IUCgrUAkLwFUh+o3/7Wdu+0JzFnAZf85V9/aCQQQmDx1b37Xey87sHHgkXotVwRYjyEIzEHAG/7mUGVrJDCwwORXADbLzVfXaxT+Axfa8NkIeOafTSkthMC0ApO/B6BcLP76tASOTiAZAW/4S6ZUJkogfoHJG4CiqDQA8Z8nZji9gPCfvgZmQCArgQgagEIDkNUpZTEDCAj/AVANSWDuApM2AMfuvXf1xT9fPfciWD+BPQSE/x44HiJAoLvApA3AY3/2/NUbAC/rPn17EshaQPhnXV6LIzCtwKQNQFUt/OGfaevv6PEKCP94a2NmBLIQmLQB8AbALM4hiwgvIPzDmxqRAIEdAhM3AKU3AO4oiJuzFxD+sz8FABAYR2CyBuAH3v2hA/USXzXOMh2FQBICwj+JMpkkgTwEJmsAnrt8ZBX+l+fBaBUEegsI/96EBiBAoI3AZA1Aed4XALUplG2zFhD+WZfX4gjEKTBZA1AtSp8AiPOcMKtxBYT/uN6ORoDAswKTNQDF0hUAZ+HsBYT/7E8BAASmE5ikATh27PRmUZarLwHyj8BcBYT/XCtv3QQiEZikAfjsCz+3+vpffwI4kpPANEYXEP6jkzsgAQI7BSZpAIrFhs//76yE23MREP5zqbR1EohcYJoGoPAGwMjPC9MbRkD4D+NqVAIEOghM0wCU3gDYoVZ2SVtA+KddP7MnkJ3A6A3Ad99770at+DXZSVoQgfUCwn+9jUcIEJhIYPQG4Mv+5AVfVa/1yonW67AExhYQ/mOLOx4BAo0ERm8AyoXL/40qY6McBIR/DlW0BgKZCozeABSFvwCY6blkWdsFhP92D7cIEIhMYIIGoPIVwJGdBKYTXED4Byc1IAECoQVGbQCeeQNg+bWhF2E8AhEJCP+IimEqBAisFxi1AfiyT734K+upXLV+Oh4hkLSA8E+6fCZPYF4CozYAZXneNwDO6/ya02qF/5yqba0EMhAYtQEoCp8AyOCcsYRLBYT/pSbuIUAgcoFxG4DSJwAiPx9Mr72A8G9vZg8CBCIQGK0BOHbs2KKoCm8AjKDophBMQPgHozQQAQJjC4zWADx2zWtXbwB87tgLdDwCAwkI/4FgDUuAwDgCozUA1XLp8//j1NRRhhcQ/sMbOwIBAgMLjNYA+AbAgStp+LEEhP9Y0o5DgMCgAuM1AFXhI4CDltLgIwgI/xGQHYIAgXEERmkALrwBsCi+bpwlOQqBQQSE/yCsBiVAYCqBURqAx170TV9RL/B5Uy3ScQn0FBD+PQHtToBAfAKjNADFYsPl//hqb0bNBIR/MydbESCQmMAoDUBV+QRAYueF6T4jIPydCQQIZCswSgNQ+AbAbE+gjBcm/DMurqURIFAUwzcAVVXW0N4A6GxLSUD4p1QtcyVAoJPA4A3A0ZMPvqKe2fM7zc5OBMYXEP7jmzsiAQITCAzeAJTl0hsAJyisQ3YSEP6d2OxEgECKAoM3AFVR+grgFM+M+c1Z+M+v5lZMYNYCgzcAta4rALM+xZJYvPBPokwmSYBASIFhG4Bn3gD410JO2FgEAgsI/8CghiNAIA2BQRuAI3ef+qs1wxemQWGWMxQQ/jMsuiUTIPCMwKANQFlsuvzvTItVQPjHWhnzIkBgFIFhG4Cy0gCMUkYHaSkg/FuC2ZwAgfwEBm0AqqrwCYD8zpnUVyT8U6+g+RMgEERguAZg9QbAqvAGwCBlMkggAeEfCNIwBAikLzBYA3DkngdfVpTFC9MnsoJMBIR/JoW0DAIEwggM1gCUhW8ADFMiowQQEP4BEA1BgEBeAoM1AMVy4Q2AeZ0rqa5G+KdaOfMmQGBQgcEagNInAAYtnMEbCQj/Rkw2IkBgjgKDNQA1pjcAzvGMimfNwj+eWpgJAQIRCgzSANxyzy/+5aooXhThek1pHgLCfx51tkoCBHoIDNIALM75BsAeNbFrPwHh38/P3gQIzERgkAag8Pr/TE6f6JYp/KMriQkRIBCrwEANQOkTALFWPN95Cf98a2tlBAgMIDBMA+ANgAOUypB7CAj/PXA8RIAAgd0EgjcAb7nrwS+vD3T1bgdzH4EBBIT/AKiGJEAgf4HgDcCyOO8PAOV/3sSyQuEfSyXMgwCB5ASCNwBl6fX/5M6CNCcs/NOsm1kTIBCJQPAGoF6XNwBGUtyMpyH8My6upREgMI7AEA2AbwAcp3ZzPcpnFtXy8PEbDj40VwDrJkCAQAiBoA3A0ZOnXlpP6otDTMwYBHYRuBD+d7zp8G/s8pi7CBAgQKCFQNAGoCw3XP5vgW/TVgLCvxWXjQkQILC3QNAGoKqWPgGwt7dHuwkI/25u9iJAgMBagaANQFH4BMBaaQ90FRD+XeXsR4AAgT0EAjcAhSsAe2B7qLWA8G9NZgcCBAg0EwjWABy558GX1Ie8ptlhbUVgXwHhvy+RDQgQINBdIFgDUFbnvQGwex3suV1A+G/3cIsAAQLBBYI1AEVVuvwfvDyzHFD4z7LsFk2AwNgC4RqA0jcAjl28DI8n/DMsqiURIBCnQLgGoNIAxFniZGYl/JMplYkSIJCDQJAG4K0nT6/e/PclOYBYwyQCwn8SdgclQGDOAkEagPPV+a+fM6K19xIQ/r347EyAAIFuAkEagKKsfAKgm//c9xL+cz8DrJ8AgckEwjQAlS8AmqyC6R5Y+KdbOzMnQCADgTANgE8AZHAqjLoE4T8qt4MRIEDgUoHeDcAP/sQDqz//u/oWQP8INBEQ/k2UbEOAAIGBBXo3ABubS6//D1ykjIYX/hkV01IIEEhboHcDUJQLDUDa58BYsxf+Y0k7DgECBBoI9G8ACp8AaOA8902E/9zPAOsnQCA6gQANgE8ARFfVuCYk/OOqh9kQIEDggkCvBuAt7z794nqUl7IksEZA+K+BcTcBAgSmFujVACzP+QbAqQsY8fGFf8TFMTUCBAj0agBKr/87g3YXEP67u7iXAAEC0Qj0agCKovQJgGhKGc1EhH80pTARAgQIrBfo1wBUPgGwnnaWjwj/WZbdogkQSFGg7Drpm+564EWXldWfdd3fftkJCP/sSmpBBAjkLND5CsBzSt8AmPOJ0XJtwr8lmM0JECAwtUDnBqD0DYBT1y6W4wv/WCphHgQIEGgh0LkBKJZe/2/hnOumwj/XyloXAQLZC3RvAEqfAMj+7Nh7gcJ/bx+PEiBAIGqBTg3AkZ983wuLovryqFdmckMK/N+yXB68402Hf2PIgxibAAECBIYT6NQAFE9vvqaeUudPEAy3HCOPIPDbZbX4xjtvPHxmhGM5BAECBAgMJNCpASgLnwAYqB4xD3uuvurzrqeKzW+6800H/zDmiZobAQIECOwvsLn/JpduUVbla6pL73ZPngJ18Bf/aVGWP3LHjdd/JM8lWhUBAgTmJ9CpAajD/+vmRzWrFZ+tV/trRVmeOr9R/cw733j9H81q9RZLgACBGQi0bgCOHTu9+dni3MtmYDOXJZ6vF/o7ZVWdqYrFw8tqeWbzqerDd7z18ONzAbBOAgQIzFGgdQPw2IuXL6mhDswRK4M1n6uv3nx0URVnlmXxcFWVZ5448ORvveeNr3sig7VZAgECBAi0EGjdAJwvl1d2eudgi0nZNIjAuaIqfq9aFGcW9bP7+kMbZx7bfOphYR/E1iAECBBIXqB1A7CxUZbVeW8BjKryVfF0/Xr9f6/fpf/wKujrz2c+/PT5pz9y4s3f+bmo5mkyBAgQIBCNQOsG4Hx57pFFsRHNAmY4kbP1M/uPXfzMfvn0VWeOH/3mJ2doYckECBAg0FGg/Zf51C8cH737gdVrxpd3PKbdmgtcEvbPu3LzQ8e+79qnmg9hSwIECBAgcKlA6ysA9aXmqjh5f325ufiGS4dzTw+BJ+pu7LfqF1fOVPUb9DbqS/nP/dTGR48du3b1OXz/CBAgQIBAUIH2DcCFw1en69eaNQBdS7F6zb4o/ufFl/Gfd/UjDx17wxtW9/tHgAABAgQGF+jYAGz8XFEsbxt8dnkc4LF6GR+u/3LCmXJZv0lvc3Hmj1746d/9j294w+rz9/4RIECAAIFJBNq/B+DZaR49ef9H619fOcms4z3oY3XQf6R49mN3VbVx5vl/9oHfOXbs2DLeKZsZAQIECMxRoOMVgPoDZ0V5Z1lUPzlHtGfX/Gj9fsiH67dEXPhCndVH795x08GPXXiPxIxRLJ0AAQIE0hDo3AA8/083/u1nrz73lnqZM7gKUD5SNzv1V+U+E/ZFef7h4zce/l+XhP2b0ii6WRIgQIAAgc4vAazojp588Jvr9wJ8oP41py8G+Ex9Gf+3L76Mf/ymaz96Sdg7dwgQIECAQMICvRqA1brr9wIcq3/8q9XvCf7703rO9dfk1m/Qqy/hF9XijL91n2AVTZkAAQIEWgv0bgDqZ8r1FwM9+G/qdwV8b+ujj7vDo/Uz+//hmf246I5GgAABAnEK9G8A6nX9wLs/dOCq84/8VP0VQf8kkmV+sg77+hl9/aU6xfJMsdh8+PgNBz8RydxMgwABAgQITC4QpAG4sIpnviL4X9a//3D9v9HeE1C/Me/jZf1u/GpR1Z+zr/+e/YFzZ37ijd/+fyaXNQECBAgQIBCxQLgG4NlF3nLXA9+0WH08sCy+Kvi6q+KP6jfjnamq6uHFYnHm3NPVw++85bo/CX4cAxIgQIAAgcwFgjcAK6/vvvfejZd+6gXfUzcBt9Y3O35MsPyD1ev19cfv6kv55Zmnq7MP13/edvWmPf8IECBAgACBngKDNAAXz+nCRwWr6vVVWX1bfbCvrR/b+VcEz9b3/WH9twV+cyvsl5efO3P8n377py8ex+8ECBAgQIBAOIHBG4CdU33rydPXnCvPX7m6v6zOn/3jqz/zSd+Lv1PJbQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBBISeD/A5PvToFe6lpCAAAAAElFTkSuQmCC"/>
              </defs>
              </svg>

            </span>
            <span class="personalise-button__text">PERSONALISE IT</span>
          </button>

          {%- if has_quantity_rules -%}
            {%- assign cart_quantity = cart | item_count_for_variant: variant.id -%}
            <div
              class="quantity-label"
              ref="quantityLabel"
            >
              {{ 'products.product.quantity' | t }}
              <span
                class="quantity-label__cart-count{% if cart_quantity == 0 %} hidden{% endif %}"
                ref="quantityLabelCartCount"
                >({{ cart_quantity }}
                {{ 'products.product.in_cart' | t }})</span
              >
            </div>
          {%- endif -%}

          <div class="product-form-buttons__row">
            {% content_for 'block', type: 'quantity', id: 'quantity' %}

            {% content_for 'block',
              type: 'add-to-cart',
              id: 'add-to-cart',
              can_add_to_cart: can_add_to_cart,
              add_to_cart_text: add_to_cart_text
            %}
          </div>

          {%- if has_quantity_rules -%}
            <div
              class="quantity-rules"
              ref="quantityRules"
            >
              {%- if variant.quantity_rule.increment > 1 -%}
                <span class="quantity-rules__item">
                  {{ 'products.product.quantity_increments' | t: increment: variant.quantity_rule.increment }}
                </span>
              {%- endif -%}
              {%- if variant.quantity_rule.min > 1 -%}
                <span class="quantity-rules__item">
                  {{ 'products.product.quantity_minimum' | t: minimum: variant.quantity_rule.min }}
                </span>
              {%- endif -%}
              {%- if variant.quantity_rule.max != null -%}
                <span class="quantity-rules__item">
                  {{ 'products.product.quantity_maximum' | t: maximum: variant.quantity_rule.max }}
                </span>
              {%- endif -%}
            </div>
          {%- endif -%}

          {%- if product.quantity_price_breaks_configured? and variant.quantity_price_breaks.size > 0 -%}
            {%- liquid
              assign use_currency = settings.currency_code_enabled_product_pages
            -%}
            <volume-pricing
              class="volume-pricing"
              data-section-id="{{ section.id }}"
              ref="volumePricing"
            >
              <span class="volume-pricing__title caption-large">{{ 'content.volume_pricing' | t }}</span>
              <div class="volume-pricing__table">
                <div class="volume-pricing__row volume-pricing__row--even">
                  <span>{{ variant.quantity_rule.min }}+</span>
                  <span>
                    {%- if use_currency -%}
                      {{- variant.price | money_with_currency | strip -}}
                    {%- else -%}
                      {{- variant.price | money | strip -}}
                    {%- endif -%}
                    /{{ 'content.each_abbreviation' | t -}}
                  </span>
                </div>
                {%- for price_break in variant.quantity_price_breaks limit: 2 -%}
                  {%- liquid
                    assign row_index = forloop.index
                    if row_index == 1
                      assign row_class = 'volume-pricing__row volume-pricing__row--odd'
                    else
                      assign row_class = 'volume-pricing__row volume-pricing__row--even'
                    endif
                  -%}
                  <div class="{{ row_class }}">
                    <span>{{ price_break.minimum_quantity }}+</span>
                    <span>
                      {%- if use_currency -%}
                        {{- price_break.price | money_with_currency | strip -}}
                      {%- else -%}
                        {{- price_break.price | money | strip -}}
                      {%- endif -%}
                      /{{ 'content.each_abbreviation' | t -}}
                    </span>
                  </div>
                {%- endfor -%}

                {%- if variant.quantity_price_breaks.size > 2 -%}
                  <div class="volume-pricing__collapsible-wrapper">
                    {%- for price_break in variant.quantity_price_breaks offset: 2 -%}
                      {%- liquid
                        assign collapsed_index = forloop.index
                        assign total_index = collapsed_index | plus: 2
                        assign modulo_result = total_index | modulo: 2
                        if modulo_result == 1
                          assign row_class = 'volume-pricing__row volume-pricing__collapsible-row volume-pricing__row--odd'
                        else
                          assign row_class = 'volume-pricing__row volume-pricing__collapsible-row volume-pricing__row--even'
                        endif
                      -%}
                      <div class="{{ row_class }}">
                        <span>{{ price_break.minimum_quantity }}+</span>
                        <span>
                          {%- if use_currency -%}
                            {{- price_break.price | money_with_currency | strip -}}
                          {%- else -%}
                            {{- price_break.price | money | strip -}}
                          {%- endif -%}
                          /{{ 'content.each_abbreviation' | t -}}
                        </span>
                      </div>
                    {%- endfor -%}
                  </div>

                  <button
                    type="button"
                    class="volume-pricing__toggle button-unstyled"
                    ref="volumePricingToggle"
                    on:click="/toggleExpanded"
                  >
                    <span class="volume-pricing__toggle-text">
                      <span class="volume-pricing__show-more">+ {{ 'actions.show_more' | t }}</span>
                      <span class="volume-pricing__show-less">- {{ 'actions.show_less' | t }}</span>
                    </span>
                  </button>
                {%- endif -%}
              </div>
            </volume-pricing>
          {%- endif -%}
          {%- unless block_settings.gift_card_form and product.gift_card? -%}
            <span
              class="product-form-text__error hidden"
              ref="addToCartTextError"
            >
              <span class="svg-wrapper product-form-icon--error">
                {{- 'icon-error.svg' | inline_asset_content -}}
              </span>
            </span>
          {%- endunless -%}

          {% comment %}
          {% content_for 'block',
            type: 'accelerated-checkout',
            id: 'accelerated-checkout',
            can_add_to_cart: can_add_to_cart,
            form_obj: form
          %}
          {% endcomment %}
        </div>
      {%- endform -%}
    </product-form-component>
  {%- else -%}
    <div class="product-form-buttons">
      <button
        type="submit"
        name="add"
        class="button"
        disabled
      >
        {{ 'blocks.sold_out' | t }}
      </button>
    </div>
  {%- endif -%}
</span>

{%- comment -%} Personalise Modal {%- endcomment -%}
{% render 'personalise-modal', product: product, variant: variant %}

<script
  src="{{ 'personalise-modal.js' | asset_url }}"
  type="module"
></script>
<script>
  // Handle personalise button clicks
  (function() {
    function openPersonaliseModal(e) {
      const button = e.target.closest('[data-personalise-button]');
      if (!button) return;
      
      e.preventDefault();
      e.stopPropagation();
      
      // Try multiple times to find the dialog (in case custom elements aren't ready)
      let attempts = 0;
      const maxAttempts = 20;
      
      function tryOpenDialog() {
        attempts++;
        const dialog = document.querySelector('personalise-dialog');
        
        if (dialog) {
          // Check if custom element is defined
          if (customElements.get('personalise-dialog')) {
            if (typeof dialog.showDialog === 'function') {
              dialog.showDialog();
              return;
            }
          }
          
          // Fallback: try to open the dialog directly
          const dialogElement = dialog.querySelector('dialog');
          if (dialogElement) {
            dialogElement.showModal();
            return;
          }
        }
        
        if (attempts < maxAttempts) {
          setTimeout(tryOpenDialog, 50);
        } else {
          console.error('Personalise dialog not found. Make sure personalise-modal.js is loaded.');
        }
      }
      
      tryOpenDialog();
    }
    
    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        document.addEventListener('click', openPersonaliseModal, true);
      });
    } else {
      // DOM already ready, but wait a bit for custom elements
      setTimeout(function() {
        document.addEventListener('click', openPersonaliseModal, true);
      }, 200);
    }
  })();
</script>

{% if block_settings.show_pickup_availability %}
  <script
    src="{{ 'local-pickup.js' | asset_url }}"
    type="module"
  ></script>

  {%- assign pick_up_availabilities = closest.product.selected_or_first_available_variant.store_availabilities
    | where: 'pick_up_enabled', true
  -%}

  <local-pickup
    class="spacing-style product__pickup-availabilities"
    {% if pick_up_availabilities.size == 0 %}
      hidden
    {% endif %}
    data-section-id="{{ section.id }}"
    data-product-url="{{ closest.product.url }}"
    data-variant-id="{{ closest.product.selected_or_first_available_variant.id }}"
    style="{% render 'spacing-style', settings: block_settings %}"
    ref="localPickupButton"
  >
    {% if can_add_to_cart %}
      <dialog-component>
        <div class="pickup-availability__row">
          <div class="pickup-availability__column">
            <span class="svg-wrapper">
              {% if pick_up_availabilities.first.available %}
                {{- 'icon-available.svg' | inline_asset_content -}}
              {% else %}
                {{- 'icon-unavailable.svg' | inline_asset_content -}}
              {% endif %}
            </span>
          </div>
          <div class="pickup-availability__column">
            {% if pick_up_availabilities.first.available %}
              <p class="pickup-location__text-sm">
                {{ 'content.pickup_available_at_html' | t: location: pick_up_availabilities.first.location.name }}
              </p>
              <p class="pickup-location__text-xs">
                {{ 'content.pickup_ready_in' | t: pickup_time: pick_up_availabilities.first.pick_up_time }}
              </p>
            {% else %}
              <p class="pickup-location__text-sm">
                {{ 'content.pickup_not_available' | t }}
              </p>
            {% endif %}
            <button
              on:click="/showDialog"
              class="button-unstyled pickup-location__button"
            >
              {{ 'actions.view_store_information' | t }}
            </button>
          </div>
        </div>
        <dialog
          ref="dialog"
          class="dialog-modal dialog-drawer pickup-location__dialog color-{{ settings.drawer_color_scheme }}"
          scroll-lock
          aria-labelledby="pickup-dialog-heading"
        >
          <h2
            id="pickup-dialog-heading"
            class="visually-hidden"
          >
            {{ 'actions.view_store_information' | t }}
          </h2>
          <div class="pickup-availability__dialog-row pickup-availability__header-container">
            <div class="pickup-availability__column">
              <h4 class="pickup-location__h4">{{ closest.product.title }}</h4>
              <p class="pickup-location__text-sm">
                {{ closest.product.selected_or_first_available_variant.title }}
              </p>
            </div>
            <button
              ref="closeButton"
              on:click="/closeDialog"
              class="button button-unstyled close-button pickup-location__close-button"
              aria-label="{{ 'actions.close_dialog' | t }}"
            >
              <span class="svg-wrapper">
                {{- 'icon-close.svg' | inline_asset_content -}}
              </span>
            </button>
          </div>
          {% for pick_up_availability in pick_up_availabilities %}
            <div class="pickup-location__wrapper">
              <p class="pickup-location__text-bold">{{ pick_up_availability.location.name }}</p>
              <div class="pickup-location__address-wrapper">
                <span class="pickup-location__availability-wrapper">
                  {% if pick_up_availability.available %}
                    {{- 'icon-available.svg' | inline_asset_content -}}
                    {% assign pickup_time = pick_up_availability.pick_up_time | downcase %}
                    {{ 'content.pickup_available_in' | t: pickup_time: pickup_time }}
                  {% else %}
                    {{- 'icon-unavailable.svg' | inline_asset_content -}}
                    {{ 'content.pickup_not_available' | t }}
                  {% endif %}
                </span>
                <address class="pickup-location__address">
                  {{ pick_up_availability.location.address | format_address }}
                  {{ pick_up_availability.location.address.phone }}
                </address>
              </div>
            </div>
          {% endfor %}
        </dialog>
      </dialog-component>
    {% endif %}
  </local-pickup>
{% endif %}

{% stylesheet %}
  .buy-buttons-block {
    --buy-button-preferred-width: 185px;

    width: 100%;
  }

  .product-form-buttons {
    display: flex;
    flex-wrap: wrap;
    flex-direction: column;
    gap: var(--gap-sm);
  }

  .product-form-buttons:not(:has(.quantity-rules)) {
    gap: var(--gap-sm);
  }

  .product-form-buttons > *:not(.quantity-selector-wrapper, .quantity-rules, .quantity-label, .volume-pricing, .personalise-button) {
    flex: 1 1 var(--buy-button-preferred-width, 0);
    min-width: fit-content;
  }

  .product-form-buttons > .quantity-selector-wrapper {
    flex: 0 0 auto;
  }

  .product-form-buttons__row {
    display: flex;
    flex-wrap: wrap;
    gap: var(--gap-sm);
    width: 100%;
    align-items: stretch;
  }

  .product-form-buttons__row > *:last-child {
    flex: 1 1 auto;
    min-width: 0;
    width: auto;
  }

  .product-form-buttons__row > span:last-child {
    flex: 1 1 auto;
    min-width: 0;
    display: flex;
  }

  .product-form-buttons__row .add-to-cart-button,
  .product-form-buttons__row [class*="add-to-cart"],
  .product-form-buttons__row add-to-cart-component,
  .product-form-buttons__row add-to-cart-component button,
  .product-form-buttons__row > span:last-child add-to-cart-component,
  .product-form-buttons__row > span:last-child add-to-cart-component button {
    flex: 1 1 auto;
    min-width: 0;
    width: 100%;
  }

  .product-form-buttons--stacked
    > *:not(.quantity-selector-wrapper, .quantity-rules, .quantity-label, .volume-pricing) {
    flex-basis: 51%;
  }

  .product-form-buttons button {
    width: 100%;
    padding-block: var(--padding-lg);
  }

  .quantity-selector {
    flex-grow: 0;
    flex-shrink: 0;
    height: var(--height-buy-buttons);
    background-color: #ffffff;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
  }

  .quantity-selector:hover {
    background-color: #ffffff;
  }

  /* .quantity-selector input[type='number'] {
    color: #333333;
  } */

  .quantity-label {
    flex: 1 0 100%;
    width: 100%;
    font-size: var(--font-size--sm);
    margin-block-end: var(--gap-xs);
  }

  .quantity-label__cart-count {
    color: var(--color-foreground-secondary);
  }

  .quantity-rules {
    display: flex;
    flex-wrap: wrap;
    gap: 0;
    row-gap: calc(var(--gap-xs) / 2);
    flex: 1 0 100%;
    width: 100%;
    font-size: var(--font-size--xs);
    color: var(--color-foreground-secondary);
    margin-block-start: var(--gap-xs);
    margin-block-end: var(--gap);
  }

  .product-form-buttons:has(~ .volume-pricing .volume-pricing__title) .quantity-rules {
    margin-block-end: var(--gap-md);
  }

  .quantity-rules__item {
    position: relative;
    display: inline-block;
    color: rgb(var(--color-foreground-rgb) / var(--opacity-subdued-text));
  }

  .quantity-rules__item:not(:last-child) {
    padding-right: var(--padding-xl);
    margin-right: var(--margin-2xs);
  }

  .quantity-rules__item:not(:last-child)::after {
    content: 'â€¢';
    position: absolute;
    inset-inline-end: 0.5rem;
    top: 50%;
    transform: translateY(-50%);
    font-size: 0.5em;
    line-height: 0;
  }

  /* Only apply these styles to add-to-cart buttons in the product form, not quick-add buttons */
  .product-form-buttons .add-to-cart-button:not(.quick-add__button) {
    height: var(--height-buy-buttons);
    text-transform: uppercase !important;
    background-color: #7295BB !important;
    color: #ffffff !important;
    border: none !important;
    font-weight: 500;
  }

  .product-form-buttons .add-to-cart-button:not(.quick-add__button):hover:not(:disabled) {
    background-color: #5a7a9a !important;
    color: #ffffff !important;
  }

  .product-form-buttons .add-to-cart-button:not(.quick-add__button):disabled {
    background-color: #cccccc !important;
    color: #666666 !important;
    cursor: not-allowed;
  }

  .product-form-buttons .add-to-cart-button.button-secondary:not(.quick-add__button) {
    text-transform: uppercase !important;
    background-color: #7295BB !important;
    color: #ffffff !important;
  }

  .product-form-buttons .add-to-cart-button.button-secondary:not(.quick-add__button):hover:not(:disabled) {
    background-color: #5a7a9a !important;
    color: #ffffff !important;
  }

  .product-form-text__error {
    display: flex;
    align-items: flex-start;
    gap: var(--gap-xs);
    margin-block-end: var(--gap-xs);
  }

  .product__pickup-availabilities {
    width: 100%;
  }

  .pickup-availability__column {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
  }

  .pickup-availability__row {
    display: flex;
    gap: var(--padding-xs);
  }

  .pickup-availability__dialog-row {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
  }

  .pickup-availability__header-container {
    padding-block-end: var(--padding-2xl);
  }

  .pickup-location__wrapper {
    display: flex;
    flex-direction: column;
    padding-block: var(--padding-2xl);
    border-top: 1px solid var(--color-border);
    gap: var(--padding-xs);
  }

  .pickup-location__address-wrapper {
    display: flex;
    flex-direction: column;
    gap: var(--padding-md);
  }

  .pickup-location__dialog {
    padding: var(--padding-2xl);
    position: fixed;
    border-radius: 0;
    width: var(--sidebar-width);
    max-width: 95vw;
    height: 100%;
    margin: 0 0 0 auto;
    border: var(--style-border-drawer);
    box-shadow: var(--shadow-drawer);
    background-color: var(--color-background);
  }

  .pickup-location__dialog:modal {
    max-height: 100dvh;
  }

  .pickup-location__text-sm {
    font-size: var(--font-size--sm);
    margin: 0;
  }

  .pickup-location__text-xs {
    font-size: var(--font-size--xs);
    margin: 0;
  }

  .pickup-location__button {
    width: fit-content;
    color: var(--color-primary);
    font-size: var(--font-size--xs);
    font-family: var(--font-body--family);
    padding: 0;
    cursor: pointer;
    margin-block: var(--margin-xs);
  }

  .pickup-location__button:hover {
    color: var(--color-primary-hover);
  }

  .pickup-location__h4 {
    margin: 0;
  }

  .pickup-location__text-bold {
    font-size: var(--font-size--md);
    font-weight: 600;
    margin: 0;
  }

  .pickup-location__availability-wrapper {
    display: flex;
    align-items: center;
    gap: var(--gap-xs);
    font-family: var(--font-paragraph--family);
  }

  .pickup-location__address {
    font-style: normal;
  }

  .pickup-location__close-button {
    top: calc(var(--padding-2xl) - (var(--icon-size-xs) / 2));
    right: calc(var(--padding-2xl) - var(--icon-size-xs));
  }

  .volume-pricing {
    display: block;
    width: 100%;
    margin-bottom: var(--gap);
  }

  .volume-pricing:not(:has(.volume-pricing__title)) {
    margin-top: 0;
    margin-bottom: 0;
  }

  .volume-pricing__title {
    display: block;
    margin-block-end: var(--gap-sm);
    font-size: var(--font-size--sm);
    font-weight: var(--font-body--weight);
    color: var(--color-foreground);
  }

  .volume-pricing__table {
    width: 100%;
  }

  .volume-pricing__row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-block: var(--padding-sm);
    padding-inline: var(--padding-md);
    font-size: var(--font-size--sm);
  }

  .volume-pricing__row--even {
    background: rgb(var(--color-foreground-rgb) / var(--opacity-5));
  }

  .volume-pricing__row--odd {
    background: var(--color-background);
  }

  .volume-pricing__collapsible-wrapper {
    block-size: 0;
    overflow-y: clip;
    opacity: 0;
    interpolate-size: allow-keywords;
    transition: opacity var(--animation-speed-slow) var(--animation-easing),
      block-size var(--animation-speed-slow) var(--animation-easing);
  }

  .volume-pricing__toggle {
    width: 100%;
    padding-bottom: 0;
    padding-inline: 0;
    text-align: left;
    color: var(--color-foreground-secondary);
    font-size: var(--font-size--xs);
    cursor: default;
    margin-block-start: 0;
    pointer-events: none;
  }

  button.volume-pricing__toggle {
    /* Need the extra specificity to override .product-form-buttons button */
    padding-block: var(--padding-sm);
  }

  .volume-pricing__toggle-text {
    cursor: pointer;
    display: inline-block;
    pointer-events: auto;
  }

  .volume-pricing__show-less {
    display: none;
  }

  .volume-pricing--expanded .volume-pricing__collapsible-wrapper {
    opacity: 1;
    block-size: auto;

    @starting-style {
      block-size: 0;
      opacity: 0;
      overflow-y: clip;
    }
  }

  .volume-pricing--expanded .volume-pricing__show-more {
    display: none;
  }

  .volume-pricing--expanded .volume-pricing__show-less {
    display: inline;
  }

  .price-per-item {
    display: block;
    color: var(--color-foreground);
    font-size: var(--font-size--sm);
    font-weight: normal;
  }

  /* Personalise Button */
  .personalise-button {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: var(--padding-md) var(--padding-lg);
    background-color: #ffffff;
    border: 1px solid #7295BB;
    border-radius: 4px;
    color: #7295BB;
    text-transform: uppercase;
    font-weight: 500;
    font-size: var(--font-size--sm);
    cursor: pointer;
    transition: all 0.2s ease;
    margin-bottom: 0;
  }

  .personalise-button:hover {
    background-color: #f8f9fa;
    border-color: #5a7a9a;
    color: #5a7a9a;
  }

  .personalise-button__icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    flex-shrink: 0;
  }

  .personalise-button__icon svg {
    width: 100%;
    height: 100%;
  }

  .personalise-button__text {
    line-height: 1;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:names.product_buy_buttons",
  "tag": null,
  "settings": [
    {
      "type": "paragraph",
      "content": "t:content.resource_reference_product"
    },
    {
      "type": "checkbox",
      "id": "stacking",
      "label": "t:settings.always_stack_buttons",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_pickup_availability",
      "label": "t:settings.show_pickup_availability",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "gift_card_form",
      "label": "t:settings.gift_card_form",
      "default": true
    },
    {
      "type": "paragraph",
      "content": "t:content.gift_card_form_description"
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-inline-start",
      "label": "t:settings.left",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-inline-end",
      "label": "t:settings.right",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    }
  ],
  "presets": [
    {
      "name": "t:names.product_buy_buttons",
      "category": "t:categories.product",
      "blocks": {
        "quantity": {
          "type": "quantity",
          "static": true
        },
        "add-to-cart": {
          "type": "add-to-cart",
          "static": true,
          "settings": {
            "style_class": "button-secondary"
          }
        }
      }
    }
  ]
}
{% endschema %}

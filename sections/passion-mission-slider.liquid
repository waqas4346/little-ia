{% liquid
  assign heading = section.settings.heading
  assign subheading = section.settings.subheading
%}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>
<div
  class="
    section
    section--{{ section.settings.section_width }}
    color-{{ section.settings.color_scheme }}
    spacing-style
    passion-mission-slider-section
  "
  style="
    {% render 'spacing-style', settings: section.settings %}
  "
>
  <div class="passion-mission-slider__header">
    {% if heading != blank %}
      <h2 class="passion-mission-slider__heading">{{ heading }}</h2>
    {% endif %}
    {% if subheading != blank %}
      <p class="passion-mission-slider__subheading">{{ subheading }}</p>
    {% endif %}
  </div>

  {% if section.blocks.size > 0 %}
    <div class="passion-mission-slider__wrapper">
      <div class="passion-mission-slider__container" id="passion-mission-slider-{{ section.id }}">
        {% for block in section.blocks %}
          <div class="passion-mission-slider__block" {{ block.shopify_attributes }} data-slide-index="{{ forloop.index0 }}">
            <div class="passion-mission-slider__block-inner" style="background-color: {{ block.settings.background_color | default: '#FFFFFF' }};">
              {% if block.settings.image != blank %}
                <div class="passion-mission-slider__pagination passion-mission-slider__pagination--desktop">
                  <span class="passion-mission-slider__current-slide">1</span>/<span class="passion-mission-slider__total-slides">{{ section.blocks.size }}</span>
                </div>
              {% endif %}
              
              <div class="passion-mission-slider__block-content">
                {% if block.settings.image != blank %}
                  <div class="passion-mission-slider__image-container">
                    <div class="passion-mission-slider__image-wrapper">
                      {{
                        block.settings.image
                        | image_url: width: 1046
                        | image_tag: widths: '333, 523, 666, 1046', sizes: '(max-width: 749px) 333px, 523px', loading: 'lazy', class: 'passion-mission-slider__image', alt: block.settings.image.alt
                      }}
                    </div>
                    {% if block.settings.image != blank %}
                      <div class="passion-mission-slider__pagination passion-mission-slider__pagination--mobile">
                        <span class="passion-mission-slider__current-slide">1</span>/<span class="passion-mission-slider__total-slides">{{ section.blocks.size }}</span>
                      </div>
                    {% endif %}
                  </div>
                {% endif %}
                
                <div class="passion-mission-slider__text-content">
                  {% if block.settings.heading != blank %}
                    <h3 class="passion-mission-slider__block-heading">{{ block.settings.heading }}</h3>
                  {% endif %}
                  {% if block.settings.description != blank %}
                    <p class="passion-mission-slider__block-description">{{ block.settings.description }}</p>
                  {% endif %}
                </div>
              </div>
              
              <div class="passion-mission-slider__controls">
                {% if block.settings.image == blank %}
                  <div class="passion-mission-slider__pagination">
                    <span class="passion-mission-slider__current-slide">1</span>/<span class="passion-mission-slider__total-slides">{{ section.blocks.size }}</span>
                  </div>
                {% endif %}
                <div class="passion-mission-slider__arrows">
                  <button 
                    type="button" 
                    class="passion-mission-slider__arrow passion-mission-slider__arrow--prev" 
                    aria-label="Previous slide"
                    {% if forloop.first %}disabled{% endif %}
                  >
                    <svg class="passion-mission-slider__arrow-svg" width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <circle class="passion-mission-slider__arrow-circle" cx="20" cy="20" r="20" transform="matrix(0 -1 -1 0 40 40)" fill="#1D425A"/>
                      <path d="M23 28L15.2829 19.7267L23.5562 12.0097" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>
                  <button 
                    type="button" 
                    class="passion-mission-slider__arrow passion-mission-slider__arrow--next" 
                    aria-label="Next slide"
                    {% if forloop.last %}disabled{% endif %}
                  >
                    <svg class="passion-mission-slider__arrow-svg" width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <circle class="passion-mission-slider__arrow-circle" cx="20" cy="20" r="20" transform="rotate(-90 20 20)" fill="#1D425A"/>
                      <path d="M17 28L24.7171 19.7267L16.4438 12.0097" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  {% else %}
    <div class="passion-mission-slider__placeholder">
      <p>Please add blocks to display.</p>
    </div>
  {% endif %}
</div>

{% stylesheet %}
  .passion-mission-slider-section {
    position: relative;
  }

  /* Header Styles */
  .passion-mission-slider__header {
    text-align: center;
    margin-bottom: 40px;
    max-width: 715px;
    margin-left: auto;
    margin-right: auto;
  }

  .passion-mission-slider__heading {
    margin: 0 0 16px 0;
    font-family: 'Outfit', sans-serif;
    font-style: normal;
    font-weight: 500;
    font-size: 28px;
    line-height: 35px;
    text-align: center;
    color: #1D425A;
  }

  .passion-mission-slider__subheading {
    margin: 0;
    font-family: 'Outfit', sans-serif;
    font-style: normal;
    font-weight: 400;
    font-size: 14px;
    line-height: 160%;
    text-align: center;
    color: #1D425A;;
  }
  .passion-mission-slider__current-slide {
    font-size: 26px;
  }

  @media screen and (min-width: 750px) {
    .passion-mission-slider__header {
      margin-bottom: 48px;
    }

    .passion-mission-slider__heading {
      font-size: 32px;
      line-height: 40px;
    }

    .passion-mission-slider__subheading {
      font-size: 16px;
    }
  }

  /* Wrapper Styles */
  .passion-mission-slider__wrapper {
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .passion-mission-slider__container {
    position: relative;
    width: 100%;
    max-width: 1200px;
    overflow: hidden;
  }

  /* Block Styles */
  .passion-mission-slider__block {
    display: none;
    width: 100%;
  }

  .passion-mission-slider__block.active {
    display: block;
  }

  .passion-mission-slider__block-inner {
    position: relative;
    border-radius: 8px;
    padding: 24px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  @media screen and (min-width: 750px) {
    .passion-mission-slider__block-inner {
      padding: 40px;
    }
  }

  .passion-mission-slider__block-content {
    display: flex;
    flex-direction: column;
    gap: 45px;
  }

  @media screen and (min-width: 750px) {
    .passion-mission-slider__block-content {
      flex-direction: row;
      align-items: center;
      gap: 60px;
    }
  }

  /* Image Styles */
  .passion-mission-slider__image-container {
    display: flex;
    align-items: flex-end;
    gap: 8px;
  }

  .passion-mission-slider__image-wrapper {
    width: 100%;
    flex-shrink: 0;
    position: relative;
  }

  .passion-mission-slider__image {
    width: 100%;
    height: auto;
    display: block;
    object-fit: cover;
  }

  @media screen and (max-width: 749px) {
    .passion-mission-slider__image-container {
      flex-direction: column;
      align-items: flex-end;
      justify-content: center;
      gap: 8px;
    }
    
    .passion-mission-slider__image-wrapper {
      flex-shrink: 0;
    }
    
    .passion-mission-slider__image {
      width: 333px;
      height: 240px;
    }
    
    .passion-mission-slider__pagination--image {
      position: static;
      display: block;
      background: transparent;
      padding: 0;
      margin: 0;
      flex-shrink: 0;
    }
  }

  @media screen and (min-width: 750px) {
    .passion-mission-slider__image-container {
      flex-direction: row;
      align-items: center;
      gap: 60px;
    }
    
    .passion-mission-slider__image-wrapper {
      width: 523px;
      flex-shrink: 0;
    }

    .passion-mission-slider__image {
      width: 523px;
      height: 315px;
    }
  }

  /* Text Content Styles */
  .passion-mission-slider__text-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .passion-mission-slider__block-heading {
    margin: 0;
    font-family: 'Outfit', sans-serif;
    font-style: normal;
    font-weight: 500;
    font-size: 24px;
    line-height: 120%;
    color: #1D425A;
    text-align: left;
  }

  .passion-mission-slider__block-description {
    margin: 0;
    font-family: 'Outfit', sans-serif;
    font-style: normal;
    font-weight: 400;
    font-size: 14px;
    line-height: 160%;
    color: #1D425A;
    text-align: left;
  }

  @media screen and (min-width: 750px) {
    .passion-mission-slider__block-description {
      font-size: 16px;
    }
  }

  /* Controls Styles */
  .passion-mission-slider__controls {
    display: flex;
    justify-content: right;
    align-items: center;
    margin-top: 24px;
    gap: 12px;
  }

  @media screen and (min-width: 750px) {
    .passion-mission-slider__controls {
      position: absolute;
      bottom: 24px;
      right: 24px;
      margin-top: 0;
      justify-content: flex-end;
    }
  }

  .passion-mission-slider__pagination {
    font-family: 'Outfit';
    font-style: normal;
    font-weight: 400;
    font-size: 20px;
    line-height: 120%;
    /* or 24px */

    color: #1D425A;

  }
  
  .passion-mission-slider__pagination--desktop {
    display: none;
  }
  
  .passion-mission-slider__pagination--mobile {
    display: block;
  }
  
  .passion-mission-slider__block:not(.active) .passion-mission-slider__pagination--desktop,
  .passion-mission-slider__block:not(.active) .passion-mission-slider__pagination--mobile {
    display: none;
  }
  
  .passion-mission-slider__block.active .passion-mission-slider__pagination--desktop,
  .passion-mission-slider__block.active .passion-mission-slider__pagination--mobile {
    display: block;
  }
  
  @media screen and (max-width: 749px) {
    .passion-mission-slider__pagination--desktop {
      display: none !important;
    }
    
    .passion-mission-slider__pagination--mobile {
      display: block;
    }
    
    .passion-mission-slider__controls .passion-mission-slider__pagination {
      display: none;
    }
    .passion-mission-slider__block-inner {
      padding: 8px;
    }
    .passion-mission-slider__block-content {
      gap: 12px;
    }
  }
  
  @media screen and (min-width: 750px) {
    .passion-mission-slider__pagination--desktop {
      display: block;
      position: absolute;
      top: 24px;
      right: 24px;
      font-family: 'Outfit', sans-serif;
      font-style: normal;
      font-weight: 400;
      font-size: 20px;
      line-height: 120%;
      color: #1D425A;
    }
    
    .passion-mission-slider__pagination--mobile {
      display: none !important;
    }
    
    .passion-mission-slider__controls {
      position: static;
    }
    
    .passion-mission-slider__controls .passion-mission-slider__pagination {
      display: none;
    }
  }

  .passion-mission-slider__arrows {
    display: flex;
    gap: 12px;
    align-items: center;
  }

  .passion-mission-slider__arrow {
    width: 30px;
    height: 30px;
    padding: 0;
    border: none;
    background: transparent;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity 0.3s ease;
  }

  @media screen and (min-width: 750px) {
    .passion-mission-slider__arrow {
      width: 40px;
      height: 40px;
    }
  }

  .passion-mission-slider__arrow:hover:not(:disabled) {
    opacity: 0.8;
  }

  .passion-mission-slider__arrow:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .passion-mission-slider__arrow-svg {
    width: 100%;
    height: 100%;
    display: block;
  }
  
  .passion-mission-slider__arrow--prev:disabled .passion-mission-slider__arrow-circle {
    fill-opacity: 0.2;
  }
  
  .passion-mission-slider__arrow--next:disabled .passion-mission-slider__arrow-circle {
    fill-opacity: 0.4;
  }

  .passion-mission-slider__placeholder {
    text-align: center;
    padding: 40px 20px;
    color: #1D425A;
  }
{% endstylesheet %}

<script>
  (function() {
    const sliderId = 'passion-mission-slider-{{ section.id }}';
    const container = document.getElementById(sliderId);
    
    if (!container) return;
    
    const blocks = container.querySelectorAll('.passion-mission-slider__block');
    const totalSlides = blocks.length;
    let currentSlide = 0;
    
    if (totalSlides === 0) return;
    
    // Initialize first slide
    blocks[0].classList.add('active');
    updateControls();
    
    // Update pagination and arrow states
    function updateControls() {
      const currentSlideElements = container.querySelectorAll('.passion-mission-slider__current-slide');
      currentSlideElements.forEach(element => {
        element.textContent = currentSlide + 1;
      });
      
      // Update arrow states for all blocks
      blocks.forEach((block, index) => {
        const prevArrow = block.querySelector('.passion-mission-slider__arrow--prev');
        const nextArrow = block.querySelector('.passion-mission-slider__arrow--next');
        
        if (prevArrow) {
          prevArrow.disabled = currentSlide === 0;
        }
        if (nextArrow) {
          nextArrow.disabled = currentSlide === totalSlides - 1;
        }
      });
    }
    
    // Show slide function
    function showSlide(index) {
      if (index < 0 || index >= totalSlides) return;
      
      blocks.forEach(block => block.classList.remove('active'));
      blocks[index].classList.add('active');
      currentSlide = index;
      updateControls();
    }
    
    // Navigation functions
    function nextSlide() {
      if (currentSlide < totalSlides - 1) {
        showSlide(currentSlide + 1);
      }
    }
    
    function prevSlide() {
      if (currentSlide > 0) {
        showSlide(currentSlide - 1);
      }
    }
    
    // Add event listeners to all arrows
    blocks.forEach((block, index) => {
      const prevArrow = block.querySelector('.passion-mission-slider__arrow--prev');
      const nextArrow = block.querySelector('.passion-mission-slider__arrow--next');
      
      if (prevArrow) {
        prevArrow.addEventListener('click', function(e) {
          e.preventDefault();
          prevSlide();
        });
      }
      
      if (nextArrow) {
        nextArrow.addEventListener('click', function(e) {
          e.preventDefault();
          nextSlide();
        });
      }
    });
  })();
</script>

{% schema %}
{
  "name": "Passion Mission Slider",
  "tag": "section",
  "class": "section-wrapper",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "blocks": [
    {
      "type": "slider_block",
      "name": "Slider Block",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Block Heading"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Block description text goes here."
        },
        {
          "type": "color",
          "id": "background_color",
          "label": "Background Color",
          "default": "#FFFBF4"
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Our Passion and Mission"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subheading",
      "default": "The feeling of pure joy I see when children and family members open their items, is what ignites this passion, and drives me to keep building this beautiful community we have created. Join us in celebrating the magic of personalised moments, we are only just getting started!"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "Section width",
      "default": "page-width",
      "options": [
        {
          "value": "page-width",
          "label": "Page width"
        },
        {
          "value": "full-width",
          "label": "Full width"
        }
      ]
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "Top padding",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 48
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "Bottom padding",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 48
    }
  ],
  "presets": [
    {
      "name": "Passion Mission Slider",
      "category": "Custom",
      "blocks": [
        {
          "type": "slider_block",
          "settings": {
            "heading": "Why We Care",
            "description": "When I became a mother, it deeply struck me how many children could not thrive simply because of the circumstances they were born into. This painful realisation that children aren't born equal became the foundation of our mission.",
            "background_color": "#FFFBF4" 
          }
        }
      ]
    }
  ]
}
{% endschema %}

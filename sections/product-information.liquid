

<script type="application/ld+json">
  {{ closest.product | structured_data }}
</script>

{% capture media_gallery %}
  {%- content_for 'block',
    type: '_product-media-gallery',
    id: 'media-gallery',
    closest.product: closest.product
  -%}
{% endcapture %}

{% capture product_details %}
  {% content_for 'block',
    type: '_product-details',
    id: 'product-details',
    closest.product: closest.product
  %}
{% endcapture %}

{% capture additional_blocks %}
  {% content_for 'blocks' %}
{% endcapture %}

{% if section.settings.enable_sticky_add_to_cart %}
  {% liquid
    assign current_variant = product.selected_or_first_available_variant
    # Get the initial quantity based on quantity rules
    assign initial_quantity = current_variant.quantity_rule.min | default: 1
  %}

  <sticky-add-to-cart
    class="sticky-add-to-cart"
    data-variant-available="{{ current_variant.available }}"
    data-product-id="{{ product.id }}"
    data-current-variant-id="{{ current_variant.id }}"
    data-initial-quantity="{{ initial_quantity }}"
    data-default-variant-title="{{ 'products.product.default_title' | t }}"
  >
    <div
      class="sticky-add-to-cart__bar color-{{ settings.popover_color_scheme }}"
      data-stuck="false"
      ref="stickyBar"
      role="region"
      aria-label="{{ 'products.product.sticky_add_to_cart' | t }}"
    >
      {% liquid
        assign image_to_show = current_variant.featured_image | default: product.featured_image
      %}
      
      <div class="sticky-add-to-cart__content">
        <div class="sticky-add-to-cart__product-info">
          {% if image_to_show %}
            <div
              class="sticky-add-to-cart__image"
            >
              {% assign image_alt = image_to_show.alt | default: product.title | escape %}
              {{
                image_to_show
                | image_url: width: 120
                | image_tag:
                  loading: 'lazy',
                  alt: image_alt,
                  class: 'sticky-add-to-cart__image-img',
                  data-testid: 'sticky-product-image',
                  srcset: null,
                  sizes: null,
                  ref: 'productImage'
              }}
            </div>
          {% endif %}

          <div class="sticky-add-to-cart__info">
            <h3
              class="sticky-add-to-cart__title"
              data-testid="sticky-product-title"
            >
              {{ product.title | escape }}
            </h3>
            <div
              class="sticky-add-to-cart__price"
              data-testid="sticky-price-display"
            >
              {% render 'price', product_resource: product, show_sale_price_first: true %}
            </div>
          </div>
        </div>

        <div class="sticky-add-to-cart__actions">
          <button
            type="button"
            class="sticky-add-to-cart__personalise-button personalise-button button-unstyled"
            data-personalise-button
          >
            <span class="personalise-button__summary" data-personalise-summary style="display: none;"></span>
            <div class="icon-tex-container"> 
            <span class="personalise-button__icon">
              <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                <rect width="18" height="18" fill="url(#pattern0_860_35083)"/>
                <defs>
                <pattern id="pattern0_860_35083" patternContentUnits="objectBoundingBox" width="1" height="1">
                <use xlink:href="#image0_860_35083" transform="scale(0.00195312)"/>
                </pattern>
                <image id="image0_860_35083" width="512" height="512" preserveAspectRatio="none" xlink:href="data:image/png;base64,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"/>
                </defs>
              </svg>

            </span>
            <span class="personalise-button__text" data-personalise-text>PERSONALISE IT</span>
           </div>
          </button>
          
          
          <button
            type="button"
            class="sticky-add-to-cart__button add-to-cart-button button button--primary"
            ref="addToCartButton"
            on:click="/handleAddToCartClick"
            {% unless current_variant.available %}
              disabled
            {% endunless %}
          >
            <span
              class="add-to-cart-text"
            >
              <span class="add-to-cart-text__content">
                <span>
                  {%- if current_variant.available -%}
                    {{- 'products.product.add_to_cart' | t -}}
                  {%- elsif current_variant == blank -%}
                    {{- 'products.product.unavailable' | t -}}
                  {%- else -%}
                    {{- 'products.product.sold_out' | t -}}
                  {%- endif -%}
                </span>
                <span
                  class="quantity-display"
                  ref="quantityDisplay"
                  {% if current_variant.available and initial_quantity > 1 %}
                    style="display: inline;"
                  {% else %}
                    style="display: none;"
                  {% endif %}
                >
                  {{- ' (' -}}
                  <span ref="quantityNumber">{{- initial_quantity -}}</span>
                  {{- ')' -}}
                </span>
              </span>
            </span>
            <span class="add-to-cart__added">
              <span class="svg-wrapper add-to-cart__added-icon">
                {{- 'icon-checkmark-burst.svg' | inline_asset_content -}}
              </span>
            </span>
          </button>
        </div>
      </div>
    </div>
  </sticky-add-to-cart>
{% endif %}

{%- comment -%} Personalise Modal {%- endcomment -%}
{% render 'personalise-modal', product: product, variant: product.selected_or_first_available_variant %}

<script src="{{ 'personalise-modal.js' | asset_url }}" type="module"></script>

{%- comment -%} Size Guide Modal {%- endcomment -%}
{% render 'size-guide-modal', product: product %}

<script src="{{ 'size-guide-modal.js' | asset_url }}" type="module"></script>
<script>
  // Handle personalise button clicks for sticky bar - completely silent error handling
  (function() {
    'use strict';
    
    // Simple function to safely open the dialog when button is clicked
    function handlePersonaliseClick(e) {
      try {
        const button = e.target.closest('[data-personalise-button]');
        if (!button) return;
        
        e.preventDefault();
        e.stopPropagation();
        
        // Try to find and open the dialog with retries
        function tryOpenDialog(attempts) {
          attempts = attempts || 0;
          const maxAttempts = 40; // Increased for slower mobile devices
          
          try {
            // Check if dialog element exists in DOM
            const dialog = document.getElementById('personalise-dialog') || 
                          document.querySelector('personalise-dialog');
            
            if (dialog) {
              // Check if custom element class is defined
              const isCustomElementDefined = customElements.get('personalise-dialog');
              
              if (isCustomElementDefined) {
                // Try using the showDialog method
                if (typeof dialog.showDialog === 'function') {
                  try {
                    dialog.showDialog();
                    return; // Success!
                  } catch (err) {
                    // Continue to fallback
                  }
                }
              }
              
              // Fallback: try opening the inner dialog element directly
              const innerDialog = dialog.querySelector && dialog.querySelector('dialog');
              if (innerDialog && typeof innerDialog.showModal === 'function') {
                try {
                  innerDialog.showModal();
                  return; // Success!
                } catch (err) {
                  // Continue to retry
                }
              }
            }
            
            // If not found and we haven't exceeded attempts, try again
            if (attempts < maxAttempts) {
              setTimeout(function() {
                tryOpenDialog(attempts + 1);
              }, 100);
            }
            // Silently fail after max attempts - no errors logged
          } catch (err) {
            // Silently catch any errors - absolutely no logging
          }
        }
        
        tryOpenDialog(0);
      } catch (err) {
        // Silently handle any outer errors
      }
    }
    
    // Initialize event listener when DOM is ready
    function init() {
      try {
        // Check if personalise button exists before adding listener
        const hasButton = document.querySelector('[data-personalise-button]');
        if (hasButton) {
          document.addEventListener('click', handlePersonaliseClick, true);
        }
      } catch (err) {
        // Silently handle initialization errors
      }
    }
    
    // Wait for DOM to be ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      // DOM already ready, wait a bit to ensure custom elements are loaded
      setTimeout(init, 100);
    }
  })();
</script>

<script>
  // Function to update button text based on personalization state
  // Only define once to avoid conflicts
  if (!window.updatePersonaliseButtonText) {
    window.updatePersonaliseButtonText = function() {
      try {
        // Try multiple ways to get product ID
        let productId = document.querySelector('product-form-component')?.dataset?.productId;
        if (!productId) {
          productId = document.querySelector('sticky-add-to-cart')?.dataset?.productId;
        }
        if (!productId) {
          // Try to get from the button's closest product-form-component
          const button = document.querySelector('[data-personalise-button]');
          if (button) {
            productId = button.closest('product-form-component')?.dataset?.productId || 
                        button.closest('sticky-add-to-cart')?.dataset?.productId;
          }
        }
        
        if (!productId) {
          console.log('updatePersonaliseButtonText: Product ID not found');
          return;
        }
        
        // Convert to string to match sessionStorage key format
        productId = String(productId);
        const key = `personalisation_${productId}`;
        
        // Use sessionStorage (current session only, clears on reload)
        const savedPersonalisation = sessionStorage.getItem(key);
        
        const buttons = document.querySelectorAll('[data-personalise-button]');
        console.log('Found buttons:', buttons.length);
        
        buttons.forEach(button => {
          const textSpan = button.querySelector('[data-personalise-text]');
          const summarySpan = button.querySelector('[data-personalise-summary]');
          
          // Find the confirmation checkbox container
          // Try multiple methods to find it
          let confirmationContainer = button.nextElementSibling;
          if (!confirmationContainer || !confirmationContainer.classList?.contains('personalise-confirmation')) {
            // Try finding in the same parent
            confirmationContainer = button.parentElement?.querySelector('[data-personalise-confirmation]');
          }
          if (!confirmationContainer) {
            // Try finding in the sticky add to cart container
            const stickyContainer = button.closest('.sticky-add-to-cart__bar');
            if (stickyContainer) {
              confirmationContainer = stickyContainer.querySelector('[data-personalise-confirmation]');
            }
          }
          console.log('Confirmation container found:', confirmationContainer ? 'YES' : 'NO');
          
          if (textSpan) {
            if (savedPersonalisation) {
              try {
                const personalisation = JSON.parse(savedPersonalisation);
                
                // Format the summary: "Personalised: {name} | {date} ({color})"
                const parts = [];
                if (personalisation.name) {
                  parts.push(personalisation.name);
                }
                if (personalisation.optionalDob) {
                  parts.push(personalisation.optionalDob);
                }
                const colorText = personalisation.color || '';
                
                let summaryText = 'Personalised:';
                if (parts.length > 0) {
                  summaryText += ' ' + parts.join(' | ');
                }
                if (colorText) {
                  summaryText += ' (' + colorText + ')';
                }
                
                // Show summary and update text
                if (summarySpan) {
                  summarySpan.textContent = summaryText;
                  summarySpan.style.display = '';
                  button.classList.add('has-summary');
                }
                textSpan.textContent = 'EDIT';
                
                // Show and update confirmation checkbox
                if (confirmationContainer) {
                  const confirmTextSpan = confirmationContainer.querySelector('[data-personalise-confirm-text]');
                  if (confirmTextSpan) {
                    // Build dynamic label based on available fields
                    const fields = [];
                    if (personalisation.name) {
                      fields.push('name');
                    }
                    if (personalisation.color) {
                      fields.push('colour');
                    }
                    if (personalisation.font) {
                      fields.push('font');
                    }
                    
                    let labelText = 'I confirm that the personalisation';
                    if (fields.length > 0) {
                      if (fields.length === 1) {
                        labelText += ' (' + fields[0] + ')';
                      } else if (fields.length === 2) {
                        labelText += ' (' + fields[0] + ' and ' + fields[1] + ')';
                      } else {
                        labelText += ' (' + fields.slice(0, -1).join(', ') + ', and ' + fields[fields.length - 1] + ')';
                      }
                    }
                    labelText += ' is correct.';
                    confirmTextSpan.innerHTML = labelText + '<br>No changes can be made once it is confirmed.';
                  }
                  confirmationContainer.style.display = 'block';
                  console.log('Confirmation container displayed');
                } else {
                  console.log('Confirmation container not found for button');
                }
                
                console.log('Updated button to show summary and EDIT');
              } catch (e) {
                console.error('Error parsing personalisation:', e);
                // Fallback: just show EDIT
                if (summarySpan) {
                  summarySpan.style.display = 'none';
                  button.classList.remove('has-summary');
                }
                textSpan.textContent = 'EDIT';
                if (confirmationContainer) {
                  confirmationContainer.style.display = 'none';
                }
              }
            } else {
              // Hide summary and show PERSONALISE IT
              if (summarySpan) {
                summarySpan.style.display = 'none';
                button.classList.remove('has-summary');
              }
              textSpan.textContent = 'PERSONALISE IT';
              if (confirmationContainer) {
                confirmationContainer.style.display = 'none';
              }
              console.log('Updated button to PERSONALISE IT');
            }
          } else {
            console.log('Text span not found in button');
          }
        });
      } catch (error) {
        console.error('Error updating personalise button text:', error);
      }
    };
  }
  
  // Listen for personalisation-saved event to update button
  function handlePersonalisationSaved() {
    setTimeout(function() {
      if (window.updatePersonaliseButtonText) {
        window.updatePersonaliseButtonText();
      }
    }, 100);
  }
  
  // Set up event listeners
  try {
    document.addEventListener('personalisation-saved', handlePersonalisationSaved);
    
    // Also try to listen on the dialog element directly (wait for it to be available)
    function setupDialogListener() {
      try {
        const dialog = document.querySelector('personalise-dialog');
        if (dialog) {
          dialog.addEventListener('personalisation-saved', handlePersonalisationSaved);
        } else {
          // Try again after a short delay (max 10 attempts)
          if (setupDialogListener.attempts < 10) {
            setupDialogListener.attempts = (setupDialogListener.attempts || 0) + 1;
            setTimeout(setupDialogListener, 200);
          }
        }
      } catch (error) {
        console.error('Error setting up dialog listener:', error);
      }
    }
    setupDialogListener.attempts = 0;
    setupDialogListener();
    
    // Don't update button text on page load - everything is fresh on reload
    // Button text will be updated when personalisation is saved during the current session
  } catch (error) {
    console.error('Error setting up personalise button listeners:', error);
  }
</script>

{% render 'product-information-content',
  product_media_size: closest.product.media.size,
  section_id: section.id,
  settings: section.settings,
  media_gallery: media_gallery,
  product_details: product_details,
  additional_blocks: additional_blocks
%}

{% stylesheet %}
  .sticky-add-to-cart__bar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    opacity: 0;
    transform: translateY(100%);
    z-index: calc(var(--layer-sticky) - 1); /* Below sticky header */
    display: block;
    width: 100%;
    border-radius: 0;
    box-shadow: var(--shadow-popover);
    padding: var(--padding-md);
    background-color: #F8F3ED;
    /* Layout styling */
    display: flex;
    align-items: center;
    justify-content: center;

    @starting-style {
      opacity: 0;
      transform: translateY(100%);
    }

    &::before {
      --border: 2px;
      content: '';
      position: absolute;
      inset: calc(var(--border) * -1);
      background: linear-gradient(#F8F3ED 0 100%), linear-gradient(hsl(0 0% 0% / 0.15) 0 100%);
      
      
      border-radius: inherit;
      z-index: -1;
      backdrop-filter: blur(20px) saturate(180%) brightness(1.5);
    }
  }

  @media (prefers-reduced-motion: no-preference) {
    .sticky-add-to-cart__bar {
      transition-property: transform, opacity, display;
      transition-duration: 0.3s;
      transition-timing-function: var(--ease-out-quad);
      transition-behavior: allow-discrete;
    }
  }

  .sticky-add-to-cart__bar[data-stuck='true'] {
    transform: translateY(0%);
    opacity: 1;
  }

  sticky-add-to-cart:not([data-variant-available='true']) .sticky-add-to-cart__bar {
    opacity: 0;
    transform: translateY(100%);
    display: none;
  }

  .sticky-add-to-cart__content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--gap-lg);
    width: 100%;
    max-width: var(--page-content-width);
    margin: 0 auto;
    min-width: 0;
  }

  .sticky-add-to-cart__product-info {
    display: flex;
    align-items: center;
    gap: var(--gap-md);
    min-width: 0;
  }

  .sticky-add-to-cart__info {
    flex: 1;
    min-width: 0;
  }

  .sticky-add-to-cart__image {
    flex-shrink: 0;
    aspect-ratio: 1;
    height: var(--height-buy-buttons);
    width: var(--height-buy-buttons);
    overflow: hidden;
    border-radius: var(--style-border-radius-buttons-primary);
    background: var(--color-background-secondary);
    display: block;
  }

  .sticky-add-to-cart__image-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .sticky-add-to-cart__title {
    font-size: var(--font-paragraph-medium--size);
    font-weight: var(--font-weight-semibold);
    margin: 0;
    margin-bottom: var(--margin-2xs);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .sticky-add-to-cart__price {
    font-weight: var(--font-weight-semibold);
    font-size: var(--font-paragraph-medium--size);
    margin: 0;
  }

  .sticky-add-to-cart__actions {
    display: flex;
    flex-direction: row;
    gap: var(--gap-sm);
    flex-shrink: 0;
    align-items: stretch;
    width: 50%;
  }

  .sticky-add-to-cart__button {
    height: var(--height-buy-buttons);
    position: relative;
    text-transform: uppercase !important;
    background-color: #7295BB !important;
    color: #ffffff !important;
    border: none !important;
    font-weight: 500;
    width: 100%;
  }

  .sticky-add-to-cart__button:hover:not(:disabled) {
    background-color: #5a7a9a !important;
    color: #ffffff !important;
  }

  .sticky-add-to-cart__button:disabled {
    background-color: #cccccc !important;
    color: #666666 !important;
    cursor: not-allowed;
  }

  .sticky-add-to-cart__personalise-button {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: var(--padding-md) var(--padding-lg);
    background-color: transparent;
    border: 1px solid #7295BB;
    border-radius: 0;
    color: #7295BB;
    text-transform: uppercase;
    font-weight: 500;
    font-size: var(--font-size--sm);
    cursor: pointer;
    transition: all 0.2s ease;
    white-space: nowrap;
    height: var(--height-buy-buttons);
  }
  
  /* When summary is visible, space between left and right */
  .sticky-add-to-cart__personalise-button.has-summary {
    justify-content: space-between;
  }
  
  .sticky-add-to-cart__personalise-button .icon-tex-container {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
  }

  .sticky-add-to-cart__personalise-button:hover {
    background-color: transparent;
    border-color: #7295BB;
    color: #7295BB;
  }

  .sticky-add-to-cart__personalise-button .personalise-button__icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    flex-shrink: 0;
  }

  .sticky-add-to-cart__personalise-button .personalise-button__icon svg {
    width: 100%;
    height: 100%;
  }

  .sticky-add-to-cart__personalise-button .personalise-button__text {
    line-height: 1;
  }

  .sticky-add-to-cart__personalise-button .personalise-button__summary {
    display: inline-block;
    margin-right: var(--margin-sm);
    flex-shrink: 0;
    color: #1D425A;
    font-size: var(--font-size--sm);
    font-weight: 400;
    line-height: 1.4;
    text-transform: none;
    text-align: left;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  /* Personalisation Confirmation Checkbox */
  .sticky-add-to-cart .personalise-confirmation {
    margin-top: var(--margin-md);
    width: 100%;
  }

  .sticky-add-to-cart .personalise-confirmation__label {
    display: flex;
    align-items: flex-start;
    gap: var(--gap-sm);
    cursor: pointer;
  }

  .sticky-add-to-cart .personalise-confirmation__checkbox {
    margin: 0;
    margin-block-start: 2px;
    flex-shrink: 0;
    width: 20px;
    height: 20px;
    cursor: pointer;
    border: 1.5px solid #7295BB !important;
    border-radius: 0px;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-color: #FFFFFF;
    box-sizing: border-box;
  }

  .sticky-add-to-cart .personalise-confirmation__checkbox:checked {
    background-color: #7295BB;
    border-color: #7295BB !important;
    background-image: url("data:image/svg+xml,%3Csvg width='14' height='14' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M13.3333 4L6 11.3333L2.66667 8' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: center;
    background-size: 14px 14px;
  }

  .sticky-add-to-cart .personalise-confirmation__text {
    flex: 1;
    font-family: 'Outfit', sans-serif;
    font-style: normal;
    font-weight: 400;
    font-size: 14px;
    line-height: 140%;
    color: #1D425A;
  }

  /* Mobile adjustments */
  @media screen and (max-width: 749px) {
    .sticky-add-to-cart__bar {
      padding: var(--padding-sm);
    }

    .sticky-add-to-cart__content {
      flex-direction: row;
      align-items: center;
      justify-content: center;
      gap: var(--gap-sm);
    }

    /* Hide product info (image, title, price) on mobile */
    .sticky-add-to-cart__product-info {
      display: none;
    }

    .sticky-add-to-cart__actions {
      width: 100%;
      min-width: 0;
      display: flex;
      flex-direction: row;
      gap: var(--gap-sm);
      align-items: stretch;
    }

    .sticky-add-to-cart__personalise-button {
      flex: 0 1 auto;
      min-width: 0;
      max-width: 160px;
      width: auto;
      overflow: hidden;
    }

    .sticky-add-to-cart__personalise-button .icon-tex-container {
      overflow: hidden;
      min-width: 0;
      flex: 1 1 auto;
    }

    .sticky-add-to-cart__personalise-button .personalise-button__text,
    .sticky-add-to-cart__personalise-button .personalise-button__summary {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: inline-block;
      max-width: 100%;
    }

    .sticky-add-to-cart__button {
      flex: 1 1 0;
      min-width: 0;
      width: auto;
    }

    .add-to-cart-text__content {
      display: block;
    }

    sticky-add-to-cart:not([data-variant-available='true']) .add-to-cart-text__content {
      display: initial;
    }

    sticky-add-to-cart:not([data-variant-available='true']) .sticky-add-to-cart__button {
      width: auto;
    }
  }

  /* Small mobile - hide text content and compare price */
  @media screen and (max-width: 389px) {
    .sticky-add-to-cart__bar {
      .compare-at-price {
        display: none;
      }
    }

    .sticky-add-to-cart__title {
      display: none;
    }

    /* For product with only default variant show title */
    .sticky-add-to-cart__info[data-singleton='true'] .sticky-add-to-cart__title {
      display: block;
    }

    /* For single variant show title and variant, truncate both. variant should be identifiable with truncation */
    .sticky-add-to-cart__info[data-single-option='true'] .sticky-add-to-cart__title {
      display: block;
    }
    .sticky-add-to-cart__info[data-single-option='true'] .sticky-add-to-cart__variant {
      display: block;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:names.product_information",
  "blocks": [
    {
      "type": "@app"
    }
  ],
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "header",
      "content": "t:content.layout"
    },
    {
      "type": "select",
      "id": "content_width",
      "label": "t:settings.width",
      "options": [
        {
          "value": "content-center-aligned",
          "label": "t:options.page"
        },
        {
          "value": "content-full-width",
          "label": "t:options.full"
        }
      ],
      "default": "content-center-aligned"
    },
    {
      "type": "select",
      "id": "desktop_media_position",
      "label": "t:settings.media_position",
      "options": [
        {
          "value": "left",
          "label": "t:options.left"
        },
        {
          "value": "right",
          "label": "t:options.right"
        }
      ],
      "default": "left"
    },
    {
      "type": "checkbox",
      "id": "equal_columns",
      "label": "t:settings.equal_columns",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "limit_details_width",
      "label": "t:settings.limit_product_details_width",
      "default": false,
      "visible_if": "{{ section.settings.equal_columns }}"
    },
    {
      "type": "range",
      "id": "gap",
      "label": "t:settings.gap",
      "min": 0,
      "max": 48,
      "step": 4,
      "unit": "px",
      "default": 16
    },
    {
      "type": "checkbox",
      "id": "enable_sticky_add_to_cart",
      "label": "t:settings.enable_sticky_add_to_cart",
      "default": true
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    }
  ],
  "presets": []
}
{% endschema %}

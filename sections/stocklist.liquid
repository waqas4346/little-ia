
{% liquid
  assign section_heading = section.settings.heading
  assign section_subheading = section.settings.subheading
%}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>

<div
  class="
    section
    section--{{ section.settings.section_width }}
    color-{{ section.settings.color_scheme }}
    spacing-style
    gap-style
    stocklist-section
  "
  style="
    {%- render 'spacing-style', settings: section.settings -%}
    {%- render 'gap-style', value: section.settings.gap -%}
  "
>
  {% if section_heading != blank or section_subheading != blank %}
    <div class="stocklist-header">
      {% if section_heading != blank %}
        <h2 class="stocklist-heading">{{ section_heading }}</h2>
      {% endif %}
      {% if section_subheading != blank %}
        <p class="stocklist-subheading">{{ section_subheading }}</p>
      {% endif %}
    </div>
  {% endif %}

  <div class="stocklist-content">
    {% liquid
      assign current_country_block = blank
    %}
    {% for block in section.blocks %}
      {% if block.type == 'country' %}
        {% if current_country_block != blank %}
          </div>
        </div>
        {% endif %}
        {% assign current_country_block = block %}
        <div class="stocklist-country" {{ block.shopify_attributes }}>
          <h3 class="country-name">{{ block.settings.country_name }}</h3>
          <div class="country-locations">
      {% elsif block.type == 'location' and current_country_block != blank %}
        <div class="location-item" {{ block.shopify_attributes }}>
          <div class="location-name">{{ block.settings.location_name }}</div>
          {% if block.settings.address != blank %}
            <div class="location-address">{{ block.settings.address }}</div>
          {% endif %}
        </div>
      {% endif %}
    {% endfor %}
    {% if current_country_block != blank %}
      </div>
      </div>
    {% endif %}
  </div>
</div>

{% stylesheet %}
  .stocklist-section {
    width: 100%;
  }

  .stocklist-header {
    margin-bottom: 32px;
    text-align: center;
  }

  .stocklist-heading {
    margin: 0 0 16px 0;
    font-size: 32px;
    line-height: 1.2;
  }

  .stocklist-subheading {
    margin: 0;
    font-size: 18px;
    line-height: 1.5;
    opacity: 0.8;
  }

  .stocklist-content {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 48px;
  }

  .stocklist-country {
    width: 100%;
  }

  .country-name {
    margin: 0 0 24px 0;
    font-size: 24px;
    font-weight: 600;
    line-height: 1.3;
    padding-bottom: 16px;
    border-bottom: 2px solid currentColor;
  }

  .country-locations {
    display: flex;
    flex-direction: column;
    gap: 0px;
    padding-left: 0;
  }

  .location-item {
    width: 100%;
    padding: 16px;
    background-color: rgba(var(--color-background), 0.5);
    border-radius: 8px;
    border: 1px solid rgba(var(--color-foreground), 0.1);
  }

  .location-name {
    font-size: 18px;
    font-weight: 600;
    line-height: 1.4;
    margin-bottom: 8px;
  }

  .location-address {
    font-size: 16px;
    line-height: 1.6;
    opacity: 0.8;
    white-space: pre-line;
  }

  @media screen and (min-width: 750px) {
    .stocklist-heading {
      font-size: 40px;
    }

    .stocklist-subheading {
      font-size: 20px;
    }

    .stocklist-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 48px;
      align-items: flex-start;
    }

    .stocklist-country {
      width: 100%;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Stocklist",
  "tag": "section",
  "class": "stocklist-section-wrapper",
  "blocks": [
    {
      "type": "country",
      "name": "Country",
      "settings": [
        {
          "type": "text",
          "id": "country_name",
          "label": "Country Name",
          "default": "Country Name"
        }
      ]
    },
    {
      "type": "location",
      "name": "Location",
      "settings": [
        {
          "type": "text",
          "id": "location_name",
          "label": "Location Name",
          "default": "Location Name"
        },
        {
          "type": "textarea",
          "id": "address",
          "label": "Address",
          "info": "Enter the full address for this location"
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "header",
      "content": "Section Header"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Stocklist"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subheading"
    },
    {
      "type": "header",
      "content": "t:content.section_layout"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "t:settings.width",
      "options": [
        {
          "value": "page-width",
          "label": "t:options.page"
        },
        {
          "value": "full-width",
          "label": "t:options.full"
        }
      ],
      "default": "page-width"
    },
    {
      "type": "range",
      "id": "gap",
      "label": "t:settings.gap",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 12
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 32
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 32
    }
  ],
  "presets": [
    {
      "name": "Stocklist",
      "category": "Custom",
      "blocks": {
        "country_1": {
          "type": "country",
          "name": "Country",
          "settings": {
            "country_name": "United States"
          }
        },
        "location_1": {
          "type": "location",
          "name": "Location",
          "settings": {
            "location_name": "New York Store",
            "address": "123 Main Street\nNew York, NY 10001"
          }
        }
      },
      "block_order": ["country_1", "location_1"],
      "settings": {
        "heading": "Stocklist",
        "gap": 12,
        "padding-block-start": 48,
        "padding-block-end": 48
      }
    }
  ]
}
{% endschema %}
